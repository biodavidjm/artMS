<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>artMS: Analytical R Tools for Mass Spectrometry • artMS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="artMS: Analytical R Tools for Mass Spectrometry">
<meta property="og:description" content="artMS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">artMS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/artMS_vignette.html">artMS: Analytical R Tools for Mass Spectrometry</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/biodavidjm/artMS/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="artMS_vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>artMS: Analytical R Tools for Mass Spectrometry</h1>
                        <h4 class="author">David Jimenez-Morales</h4>
            
            <h4 class="date">2021-01-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/biodavidjm/artMS/blob/master/vignettes/artMS_vignette.Rmd"><code>vignettes/artMS_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>artMS_vignette.Rmd</code></div>

    </div>

    
    
<!--
(---------------------------------------------------------------------)
-->
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>OVERVIEW</h1>
<p><a href="http://bioconductor.org/packages/release/bioc/html/artMS.html">artMS</a> is a <a href="http://bioconductor.org">Bioconductor</a> package that provides a set of tools for the analysis and integration of large-scale proteomics (mass-spectrometry-based) datasets obtained using the popular proteomics software <a href="http://www.biochem.mpg.de/5111795/maxquant">MaxQuant</a>.</p>
<p>The functions available in artMS, which can be grouped into the following categories:</p>
<ul>
<li>Multiple quality control (QC) functions.</li>
<li>Relative quantification using <a href="http://msstats.org/">MSstats</a>.</li>
<li>Downstream analysis and integration of quantifications (enrichment, clustering, PCA, summary plots, etc)</li>
<li>Generation of input files for other tools, including <a href="http://saint-apms.sourceforge.net/Main.html">SAINTq</a>, <a href="http://saint-apms.sourceforge.net/Main.html">SAINTexpress</a>, <a href="https://github.com/jdrudolph/photon">Photon</a>, and <a href="http://phosfate.com/">Phosfate</a>
</li>
</ul>
<p><a href="https://biodavidjm.github.io/artMS/reference/index.html">Click here for details about all the functions available in artMS</a>.</p>
<p>For a graphical overview check <a href="https://mass-spec.stanford.edu/sites/g/files/sbiybj8411/f/sites/default/files/2019SUMS-RAS_artMS_Jimenez-Morales.pdf">the slides presented at the 2019 SUMS-RAS</a> (Stanford University Mass Spectrometry - Research Application Symposium)</p>
<p><em><a href="https://bioconductor.org/packages/3.12/artMS">artMS</a></em> also perfoms basic quality control and relative quantification for <strong>metabolomics</strong> datasets obtained using the alignment table generated by <a href="https://sciex.com/products/software/markerview-software">MarkerView</a>. However, this functionality is not stable.</p>
<div id="how-to-install" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-install" class="anchor"></a>How to install</h2>
<p>Before you begin, ensure that your system is running an <code>R version &gt;= 3.6</code> or the installation of <code>artMS</code> won’t work. You can check the R version running on your system by executing the function <code><a href="https://rdrr.io/r/base/numeric_version.html">getRversion()</a></code></p>
<p>If the outcome is <code>&gt;= 3.6.0</code>, congratulations! you can move forward. If it is not, then you need to <a href="https://www.r-project.org/">install the latest version of R in your system</a>.</p>
<p>Two options to install <em><a href="https://bioconductor.org/packages/3.12/artMS">artMS</a></em>:</p>
<ul>
<li>
<strong>Official BioConductor releases (recommended)</strong>. <em><a href="https://bioconductor.org/packages/3.12/artMS">artMS</a></em> is available in <a href="https://www.bioconductor.org/">BioConductor</a>. Instructions on how to install the package are available <a href="https://bioconductor.org/packages/3.12/artMS">here</a>.</li>
</ul>
<p>(Why Bioconductor? <a href="https://bioinformatics.stackexchange.com/questions/639/why-bioconductor">Here you can find a nice summary of many good reasons</a>).</p>
<ul>
<li>
<strong>Development version from Github</strong>. (<strong><em>Warning</em></strong>: not stable, but it has the latest). Assuming that you have an <code>R (&gt;= 3.6)</code> version running on your system, follow these steps:</li>
</ul>
<pre><code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("devtools")
library(devtools)
install_github("biodavidjm/artMS")</a></code></pre>
<p>Once installed, the package can be loaded and attached to your current workspace as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://artms.org">artMS</a></span><span class="op">)</span></code></pre></div>
<pre><code>## </code></pre>
<pre><code>## </code></pre>
</div>
<div id="input-files" class="section level2">
<h2 class="hasAnchor">
<a href="#input-files" class="anchor"></a>Input files</h2>
<p><em><a href="https://bioconductor.org/packages/3.12/artMS">artMS</a></em> performs the different analyses taking as input the following files:</p>
<ul>
<li>
<strong>evidence.txt</strong> file: output of the quantitative proteomics software package <strong>MaxQuant</strong>.</li>
<li>
<strong>keys.txt</strong> (tab-delimited) txt file generated <strong>by the user</strong> describing the experimental design.</li>
<li>
<strong>contrast.txt</strong> (tab-delimited) txt file generated <strong>by the user</strong> with the comparisons between conditions to be quantified.</li>
</ul>
<p>Check <a href="#inputfiles">below</a> to find out more about generating the input files.</p>
</div>
<div id="configuration-file" class="section level2">
<h2 class="hasAnchor">
<a href="#configuration-file" class="anchor"></a>Configuration file</h2>
<p><code><a href="../reference/artmsQuantification.html">artmsQuantification()</a></code> requires a large number of arguments, specially those related to the statistical package <em><a href="https://bioconductor.org/packages/3.12/MSstats">MSstats</a></em>. To facilite the task of providing all those arguments, the function <code><a href="../reference/artmsQuantification.html">artmsQuantification()</a></code> takes a config file (in <code>yaml</code> format) for the customization of the parameters for quantification (using <code>MSstats</code>) and other operations, including QC analyses, charts, and annotations.</p>
<p>A configuration file template can be generated by running <code><a href="../reference/artmsWriteConfigYamlFile.html">artmsWriteConfigYamlFile()</a></code></p>
<p>Check <a href="#configfile">below</a> to learn the details of the configuration file.</p>
</div>
<div id="basic-workflows" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-workflows" class="anchor"></a>Basic workflows</h2>
<div id="proteomics" class="section level3">
<h3 class="hasAnchor">
<a href="#proteomics" class="anchor"></a>Proteomics</h3>
<ul>
<li><p><strong>Generate the input files</strong>: Check the <a href="#inputfiles">input files</a> section for details</p></li>
<li>
<p><strong>Quality Control</strong>: if you are interested in performing only quality control analysis, run the following functions:</p>
<ul>
<li>
<code><a href="../reference/artmsQualityControlEvidenceBasic.html">artmsQualityControlEvidenceBasic()</a></code>: QC based on the <code>evidence.txt</code> file</li>
<li>
<code><a href="../reference/artmsQualityControlEvidenceExtended.html">artmsQualityControlEvidenceExtended()</a></code>: based on the <code>evidence.txt</code> file</li>
<li>
<code><a href="../reference/artmsQualityControlSummaryExtended.html">artmsQualityControlSummaryExtended()</a></code>: based on the <code>summary.txt</code> file</li>
</ul>
</li>
<li>
<p><strong>Relative Quantification</strong>: fill up the configuration file and run the following function:</p>
<ul>
<li>
<code><a href="../reference/artmsQuantification.html">artmsQuantification(yaml_config_file = "config.yaml")</a></code> (<a href="#relquan">here the details</a>)</li>
</ul>
</li>
<li>
<p><strong>Analysis of Quantifications</strong>: performs annotations, clustering analysis, PCA analysis, enrichment analysis by running the function</p>
<ul>
<li>
<code><a href="../reference/artmsAnalysisQuantifications.html">artmsAnalysisQuantifications()</a></code> (<a href="#analysisquan">here the details</a>)</li>
</ul>
</li>
<li><p><strong>Miscellaneous functions</strong>: Check <a href="#misc">below</a> to discover more useful functions provided by the <code>artMS</code> package.</p></li>
</ul>
</div>
<div id="metabolomics-unstable" class="section level3">
<h3 class="hasAnchor">
<a href="#metabolomics-unstable" class="anchor"></a>Metabolomics (unstable)</h3>
<p><em><a href="https://bioconductor.org/packages/3.12/artMS">artMS</a></em> also enables the relative quantification of untargeted polar metabolites using the alignment table generated by <a href="https://sciex.com/products/software/markerview-software">MarkerView</a>. This means that the metabolites do not need to have an <code>ID</code>, as the <code>m/z</code> and <code>retention time</code> will be used as identifiers. Typical workflow:</p>
<ul>
<li><p>Run QC on the metabolomics dataset: <code><a href="../reference/artmsQualityControlMetabolomics.html">artmsQualityControlMetabolomics()</a></code></p></li>
<li><p>Relative quantification: <code><a href="../reference/artmsQuantification.html">artmsQuantification()</a></code> (notice that a few options must be changed in the config file before running the function)</p></li>
</ul>
<p>Please, keep in mind that most of the functions available in artMS don’t work for metabolomics data due to annotation issues (protein/gene ids are the primary ids for most of the functions). Check the <a href="#metabolomics">metabolomics section</a> to find out more.</p>
<!--
(-----------------------------------------------------------------------------)
-->
</div>
</div>
</div>
<div id="required-input-files" class="section level1">
<h1 class="hasAnchor">
<a href="#required-input-files" class="anchor"></a>REQUIRED INPUT FILES</h1>
<p><a name="inputfiles"></a></p>
<div id="input-files-1" class="section level2">
<h2 class="hasAnchor">
<a href="#input-files-1" class="anchor"></a>Input files</h2>
<p>Three basic (tab-delimited) files are required to perform the full pack of operations:</p>
<div id="evidence-txt" class="section level3">
<h3 class="hasAnchor">
<a href="#evidence-txt" class="anchor"></a><code>evidence.txt</code>
</h3>
<p>The output of the quantitative proteomics software package <a href="http://www.biochem.mpg.de/5111795/maxquant">MaxQuant</a>. It combines all the information about the identified peptides.</p>
</div>
<div id="keys-txt" class="section level3">
<h3 class="hasAnchor">
<a href="#keys-txt" class="anchor"></a><code>keys.txt</code>
</h3>
<p>Tab delimited file generated by the user. It summarizes the experimental design of the evidence file. <code>artMS</code> merges the <code>keys.txt</code> and <code>evidence.txt</code> by the “RawFile” column. Each RawFile corresponds to a unique individual experimental technical replicate / biological replicate / Condition / Run.</p>
<p>For any basic label-free proteomics experiment, the keys file <strong>must contain</strong> the following columns and rules:</p>
<ul>
<li>
<strong>RawFile</strong>: The name of the RAW-file for which the mass spectral data was derived from.</li>
<li>
<strong>IsotopeLabelType</strong>: <code>'L'</code> for label free experiments (<code>'H'</code> will be used for SILAC experiments, <a href="#silac">see below</a>)</li>
<li>
<strong>Condition</strong>: The conditions names must follow these rules:
<ul>
<li>Use only letters (A - Z, both uppercase and lowercase) and numbers (0 - 9). The only special character allowed is underscore (<code>_</code>).</li>
<li>
<strong>Very important: A condition name cannot begin with a number (R limitation)</strong>.</li>
</ul>
</li>
<li>
<strong>BioReplicate</strong>: biological replicate number. It is based on the condition name. Use as prefix the corresponding <code>Condition</code> name, and add as suffix <code>dash (-)</code> plus the biological replicate number. For example, if condition <code>H1N1_06H</code> has too biological replicates, name them <code>H1N1_06H-1</code> and <code>H1N1_06H-2</code>
</li>
<li>
<strong>Run</strong>: a <strong>unique number</strong> for all the MS runs (from 1 to the total number of raw files). It will be especially useful when having technical replicates. For example, in the table below, there are 2 technical replicates of the same biological replicate (Cal_33-1, technical replicates 1 and 2). A special case is SILAC experiments (H and L label are run simultaneously. See <a href="#silac">below</a> to find out more)</li>
</ul>
<table class="table">
<thead><tr class="header">
<th><strong>RawFile</strong></th>
<th><strong>IsotopeLabelType</strong></th>
<th><strong>Condition</strong></th>
<th><strong>BioReplicate</strong></th>
<th><strong>Run</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>qx006145</td>
<td>L</td>
<td>Cal_33</td>
<td>Cal_33-1</td>
<td>1</td>
</tr>
<tr class="even">
<td>qx006146</td>
<td>L</td>
<td>Cal_33</td>
<td>Cal_33-1</td>
<td>2</td>
</tr>
<tr class="odd">
<td>qx006148</td>
<td>L</td>
<td>Cal_33</td>
<td>Cal_33-2</td>
<td>3</td>
</tr>
<tr class="even">
<td>qx006151</td>
<td>L</td>
<td>HSC6</td>
<td>HSC6-1</td>
<td>4</td>
</tr>
<tr class="odd">
<td>qx006152</td>
<td>L</td>
<td>HSC6</td>
<td>HSC6-2</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>For more examples, check the artMS data object <code>artms_data_ph_keys</code></p>
<p><em>Tip</em>: it is recommended to use Microsoft Excel (OpenOffice Cal / or similar) to generate the keys file. <em>Do not forget</em> to choose the <em>format = Tab Delimited Text (.txt)</em> when saving the file (use <em>save as</em> option)</p>
</div>
<div id="contrast-txt" class="section level3">
<h3 class="hasAnchor">
<a href="#contrast-txt" class="anchor"></a><code>contrast.txt</code>
</h3>
<p>The comparisons between conditions that the user wants to quantify.</p>
<ul>
<li>Example #1: the comparison for the keys described above would be:</li>
</ul>
<pre><code>HSC6-Cal_33</code></pre>
<ul>
<li>Example #2: let’s quantify changes in protein abundance between wild type (<code>WT_A549</code>) relative to two additional experimental conditions with drugs (<code>WT_DRUG_A</code> and <code>WT_DRUG_B</code>), but also changes in protein abundance between <code>DRUG_A</code> and <code>DRUG_B</code>, the contrast file would look like this:</li>
</ul>
<pre><code>WT_DRUG_A-WT_A549
WT_DRUG_B-WT_A549
WT_DRUG_A-WT_DRUG_B</code></pre>
<p><strong>Requirements</strong>:</p>
<ul>
<li>The two conditions to be compared must be separated by a dash symbol (<code><a href="https://rdrr.io/r/base/Arithmetic.html">-</a></code>), and only one dash symbol is allowed, i.e., only one comparison per line.</li>
</ul>
<p>As a result of the quantification, the condition on the left will take the positive log2FC sign -if the protein is more abundant in condition on the left (numerator), and the condition on the right the negative log2FC -if a protein is more abundant in condition on the right term (denominator).</p>
<p><strong>Example of wrong comparisons</strong></p>
<p>Only condition names are allowed. Individual Bioreplicates cannot be compared. For example, this is wrong:</p>
<pre><code>HSC6-Cal_33-1</code></pre>
<p><a name="configfile"></a></p>
</div>
</div>
<div id="the-artms-configuration-file" class="section level2">
<h2 class="hasAnchor">
<a href="#the-artms-configuration-file" class="anchor"></a>The artMS configuration file</h2>
<p>The configuration file (in <code>yaml</code> format) contains a variety of options available for the QC, quantification, and annotations performed by <code>artMS</code>.</p>
<p>To generate a sample configuration file, go to the project folder (<code>setwd(/path/to/your/working/folder/)</code>) and execute:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://artms.org">artMS</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/artmsWriteConfigYamlFile.html">artmsWriteConfigYamlFile</a></span><span class="op">(</span>config_file_name <span class="op">=</span> <span class="st">"my_config.yaml"</span><span class="op">)</span></code></pre></div>
<p>Open the <code>my_config.yaml</code> file with your favorite editor (RStudio for example). <em>Note: Although the configuration file might look complex, the default options work very well</em>.</p>
<p>The configuration (<code>yaml</code>) file contains the following sections:</p>
<div id="section-files" class="section level3">
<h3 class="hasAnchor">
<a href="#section-files" class="anchor"></a>Section: <code>files</code>
</h3>
<pre><code>files :
  evidence : /path/to/the/evidence.txt
  keys : /path/to/the/keys.txt
  contrasts : /path/to/the/contrast.txt
  summary: /path/to/the/summary.txt # Optional
  output : /path/to/the/results_folder/ph-results.txt</code></pre>
<p>The file <code>path/name</code> of the required files. It is recommended to create a new folder in your folder project (for example, <code>results_folder</code>). The results file name (e.g. <code>-results.txt</code>) will be used as prefix for the several files (<code>txt</code> and <code>pdf</code>) that will be generated.</p>
<hr>
</div>
<div id="section-qc" class="section level3">
<h3 class="hasAnchor">
<a href="#section-qc" class="anchor"></a>Section: <code>qc</code>
</h3>
<pre><code>qc:
  basic: 1 # 1 = yes; 0 = no
  extended: 1 # 1 = yes; 0 = no
  extendedSummary: 0 # 1 = yes; 0 = no</code></pre>
<p>Select to perform both ‘basic’ and ‘extended’ quality control based on the <code>evidence.txt</code> file or ‘extendedSummary’ based on the <code>summary.txt</code> file. <a href="#qualitycontrol">Read below</a> to find out more about the details of each type of analysis.</p>
</div>
<div id="section-data" class="section level3">
<h3 class="hasAnchor">
<a href="#section-data" class="anchor"></a>Section: <code>data</code>
</h3>
<pre><code>data:
  enabled : 1 # 1 = yes; 0 = no
  fractions: 
    enabled : 0 # 1 for protein fractionation
  silac: 
    enabled : 0 # 1 for SILAC experiments
  filters: 
    enabled : 1
    contaminants : 1
    protein_groups : remove # remove, keep
    modifications : AB # PH, UB, AC, AB, APMS
  sample_plots : 1 # correlation plots</code></pre>
<p>Let’s break it down <code>data</code>:</p>
<ul>
<li><p><code>enabled : 1</code>: to pre-process the data provided in the <em>files</em> section. <code>0</code>: won’t process the data (and a pre-generated MSstats file will be expected)</p></li>
<li>
<p><code>fractions</code>: Multiple fractionation or separation methods are often combined in proteomics to improve signal-to-noise and proteome coverage and to reduce interference between peptides in quantitative proteomics.</p>
<ul>
<li>
<code>enabled : 1</code> for fractionation dataset. See <strong>Special case: Protein Fractionation</strong> <a href="#fractions">below</a> for details</li>
<li>
<code>enabled : 0</code> no fractions</li>
</ul>
</li>
<li>
<p><code>silac</code>:</p>
<ul>
<li>
<code>enabled : 1</code>: check if the files belong to a SILAC experiment. See <strong>Special case: SILAC</strong> <a href="#silac">below</a> for details</li>
<li>
<code>enabled : 0</code>: no silac experiment (default)</li>
</ul>
</li>
<li>
<p><code>filters</code>:</p>
<ul>
<li>
<code>enabled : 1</code> Enables filtering (this section)</li>
<li>
<code>contaminants : 1</code> Removes contaminants (<code>CON__</code> and <code>REV__</code> labeled by MaxQuant)</li>
<li>
<code>protein_groups : remove</code> choose whether <code>remove</code> or <code>keep</code> protein groups</li>
<li>
<code>modifications : AB</code> any of the proteomics experiments, <code>PH</code>, <code>UB</code>, or <code>AC</code> for posttranslational modifications, <code>AB</code> or <code>APMS</code> otherwise.</li>
</ul>
</li>
<li>
<p><code>sample_plots</code></p>
<ul>
<li>
<code>1</code> Generate correlation plots</li>
<li>
<code>0</code> otherwise</li>
</ul>
</li>
</ul>
<hr>
</div>
<div id="section-msstats" class="section level3">
<h3 class="hasAnchor">
<a href="#section-msstats" class="anchor"></a>Section: <code>MSstats</code>
</h3>
<pre><code>msstats :
  enabled : 1
  msstats_input : # `-mss.txt` file or blank (default)
  profilePlots : none 
  normalization_method : equalizeMedians
  normalization_reference :  # blank (default) if equalizeMedians
  summaryMethod : TMP 
  censoredInt : NA  
  cutoffCensored : minFeature  
  MBimpute : 1 
  feature_subset: all</code></pre>
<p>Let’s break it down:</p>
<ul>
<li>
<code>enabled :</code> Choose <code>1</code> to run MSstats, <code>0</code> otherwise.</li>
<li>
<code>msstats_input :</code> leave it blank if MSstats will be run (previous <code>enabled : 1</code>). But if MSstats was already run and the <code>evidence-mss.txt</code> file is available, then choose <code>enabled : 0</code> and provide here the <code>evidence-mss.txt</code> file path/name</li>
<li>
<code>profilePlots :</code> Choose one of the following options:
<ul>
<li>
<code>before</code> plot before normalization</li>
<li>
<code>after</code> plot after normalization</li>
<li>
<code>before-after</code>: recommended, although computational expensive</li>
<li>
<code>none</code> no normalization plots</li>
</ul>
</li>
<li>
<code>normalization_method :</code> available options:
<ul>
<li><code>equalizeMedians</code></li>
<li><code>quantile</code></li>
<li>
<code>0</code>: no normalization (not recommended)</li>
<li>
<code>globalStandards</code> if selected, specified the reference protein in <code>normalization_reference</code> (next)</li>
</ul>
</li>
<li>
<code>normalization_reference :</code> UniProt id if <code>globalStandards</code> is chosen as the <code>normalization_method</code> (above)</li>
<li>
<code>summaryMethod :</code> TMP # “TMP”(default) means Tukey’s median polish, which is robust estimation method. “linear” uses linear mixed model. “logOfSum” conducts log2 (sum of intensities) per run.</li>
<li>
<code>censoredInt :</code>
<ul>
<li>
<code>NA</code> (default) Missing values are censored or at random. ‘NA’ assumes that all ‘NA’s in ’Intensity’ column are censored.</li>
<li>
<code>0</code> uses zero intensities as censored intensity. In this case, NA intensities are missing at random. The output from Skyline should use <code>0</code>. Null assumes that all <code>NA</code> intensities are randomly missing.</li>
</ul>
</li>
<li>
<code>cutoffCensored :</code>
<ul>
<li>
<code>minFeature</code> Cutoff value for censoring. Only with <code>censoredInt : NA</code> or <code>0</code>. Default is ‘minFeature’, which uses minimum value for each feature.</li>
<li>
<code>minFeatureNRun</code> uses the smallest between minimum value of corresponding feature and minimum value of corresponding run.</li>
<li>
<code>minRun</code> uses minimum value for each run.</li>
</ul>
</li>
<li>
<code>MBimpute :</code>
<ul>
<li>
<code>TRUE</code> only for <code>summaryMethod="TMP"</code> and <code>censoredInt='NA'</code> or <code>0</code>. TRUE (default) imputes ‘NA’ or ‘0’ (depending on censoredInt option) by Accelerated failure model.</li>
<li>
<code>FALSE</code> uses the values assigned by cutoffCensored.</li>
</ul>
</li>
<li>
<code>feature_subset :</code>
<ul>
<li>
<code>all</code> : default</li>
<li>
<code>highQuality</code> : this option seems to be buggy right now</li>
</ul>
</li>
</ul>
<p>Check <a href="http://msstats.org/">MSstats documentation</a> to find out more about every option.</p>
<hr>
</div>
<div id="section-output_extras" class="section level3">
<h3 class="hasAnchor">
<a href="#section-output_extras" class="anchor"></a>Section: <code>output_extras</code>
</h3>
<pre><code>  enabled : 1 # if 0, won't process anything on this section
  annotate :  
    enabled: 1 
    species : HUMAN
  plots:
    volcano: 1
    heatmap: 1
    LFC : -1 1 # Range of minimal log2fc
    FDR : 0.05 # adjusted p-value, false discovery rate
    heatmap_cluster_cols : 0
    heatmap_display : log2FC # log2FC or pvalue</code></pre>
<p>Extra actions to perform based on the MSstats results, including <em>annotations</em> and <em>plots</em> (heatmaps and volcano plots). Let’s break it down:</p>
<ul>
<li>
<code>enabled :</code> 1 (default) enables this section, 0 turns it off</li>
<li>
<code>annotate :</code>
<ul>
<li>
<code>enabled</code>: 1 (default), will generate a <code>-results-annotated.txt</code> file that includes <code>Gene</code> and <code>Protein.Name</code> (only for supported species)</li>
<li>
<code>species</code>: The supported species are: HUMAN, MOUSE, ANOPHELES, ARABIDOPSIS, BOVINE, WORM, CANINE, FLY, ZEBRAFISH, ECOLI_STRAIN_K12, ECOLI_STRAIN_SAKAI, CHICKEN, RHESUS, MALARIA, CHIMP, RAT, YEAST, PIG, XENOPUS</li>
</ul>
</li>
<li>
<code>plots :</code> options for additional plots
<ul>
<li>
<code>volcano :</code> 1</li>
<li>
<code>LFC :</code> log2 fold change cutoff (minimal negative and positive value)</li>
<li>
<code>FDR :</code> false discovery rate cutoff for significance (recommended: 0.05)</li>
<li>
<code>heatmap :</code> correlation plots</li>
<li>
<code>heatmap_cluster_cols :</code> 1 perfoms clustering of columns, 0 (default) doesn’t</li>
<li>
<code>heatmap_display :</code> choose to display either <code>log2FC</code> or <code>pvalue</code>
</li>
</ul>
</li>
</ul>
<p><a name="fractions"></a></p>
</div>
</div>
<div id="special-case-protein-fractionation" class="section level2">
<h2 class="hasAnchor">
<a href="#special-case-protein-fractionation" class="anchor"></a>Special case: Protein fractionation</h2>
<p>To handle protein fractionation experiments, two options must be activated</p>
<ol style="list-style-type: decimal">
<li>
<code>keys.txt</code>: The keys file must contain an additional column named “<code>FractionKey</code>” with the information about fractions. For example:</li>
</ol>
<table class="table">
<thead><tr class="header">
<th align="center"><strong>Raw.file</strong></th>
<th align="center"><strong>IsotopeLabelType</strong></th>
<th align="center"><strong>Condition</strong></th>
<th align="center"><strong>BioReplicate</strong></th>
<th align="center"><strong>Run</strong></th>
<th align="center"><strong>FractionKey</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">S9524_Fx1</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">S9524_Fx2</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-1</td>
<td align="center">1</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">S9524_Fx3</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-1</td>
<td align="center">1</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">S9524_Fx4</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-1</td>
<td align="center">1</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="center">S9524_Fx5</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-1</td>
<td align="center">1</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">S9524_Fx6</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-1</td>
<td align="center">1</td>
<td align="center">6</td>
</tr>
<tr class="odd">
<td align="center">S9524_Fx7</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-1</td>
<td align="center">1</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="center">S9524_Fx8</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-1</td>
<td align="center">1</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="center">S9524_Fx9</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-1</td>
<td align="center">1</td>
<td align="center">9</td>
</tr>
<tr class="even">
<td align="center">S9524_Fx10</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-1</td>
<td align="center">1</td>
<td align="center">10</td>
</tr>
<tr class="odd">
<td align="center">S9525_Fx1</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-2</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">S9525_Fx2</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-2</td>
<td align="center">2</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">S9525_Fx3</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-2</td>
<td align="center">2</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">S9525_Fx4</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-2</td>
<td align="center">2</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="center">S9525_Fx5</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-2</td>
<td align="center">2</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">S9525_Fx6</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-2</td>
<td align="center">2</td>
<td align="center">6</td>
</tr>
<tr class="odd">
<td align="center">S9525_Fx7</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-2</td>
<td align="center">2</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="center">S9525_Fx8</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-2</td>
<td align="center">2</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="center">S9525_Fx9</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-2</td>
<td align="center">2</td>
<td align="center">9</td>
</tr>
<tr class="even">
<td align="center">S9525_Fx10</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-2</td>
<td align="center">2</td>
<td align="center">10</td>
</tr>
<tr class="odd">
<td align="center">S9526_Fx1</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-3</td>
<td align="center">3</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">S9526_Fx2</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-3</td>
<td align="center">3</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">S9526_Fx3</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-3</td>
<td align="center">3</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">S9526_Fx4</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-3</td>
<td align="center">3</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="center">S9526_Fx5</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-3</td>
<td align="center">3</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">S9526_Fx6</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-3</td>
<td align="center">3</td>
<td align="center">6</td>
</tr>
<tr class="odd">
<td align="center">S9526_Fx7</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-3</td>
<td align="center">3</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="center">S9526_Fx8</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-3</td>
<td align="center">3</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="center">S9526_Fx9</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-3</td>
<td align="center">3</td>
<td align="center">9</td>
</tr>
<tr class="even">
<td align="center">S9526_Fx10</td>
<td align="center">L</td>
<td align="center">AB</td>
<td align="center">AB-3</td>
<td align="center">3</td>
<td align="center">10</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: decimal">
<li>
<code>config.yaml</code>: Enable <em>fractions</em> in the configuration file as follow:</li>
</ol>
<pre><code>fractions: 
  enabled : 1 # 1 for protein fractions, 0 otherwise</code></pre>
<p><a name="silac"></a></p>
</div>
<div id="special-case-silac" class="section level2">
<h2 class="hasAnchor">
<a href="#special-case-silac" class="anchor"></a>Special case: SILAC</h2>
<p>One of the most widely used techniques that enable relative protein quantification is <em>stable isotope labeling by amino acids in cell culture</em> (SILAC). The <code>keys.txt</code> file can capture the typical SILAC experiment. The following example shows a SILAC experiment with two conditions, two biological replicates, and two technical replicates:</p>
<table class="table">
<thead><tr class="header">
<th align="center"><strong>RawFile</strong></th>
<th align="center"><strong>IsotopeLabelType</strong></th>
<th align="center"><strong>Condition</strong></th>
<th align="center"><strong>BioReplicate</strong></th>
<th align="center"><strong>Run</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">QE20140321-01</td>
<td align="center">H</td>
<td align="center">iso</td>
<td align="center">iso-1</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">QE20140321-02</td>
<td align="center">H</td>
<td align="center">iso</td>
<td align="center">iso-1</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">QE20140321-04</td>
<td align="center">L</td>
<td align="center">iso</td>
<td align="center">iso-2</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">QE20140321-05</td>
<td align="center">L</td>
<td align="center">iso</td>
<td align="center">iso-2</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="center">QE20140321-01</td>
<td align="center">L</td>
<td align="center">iso_M</td>
<td align="center">iso_M-1</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">QE20140321-02</td>
<td align="center">L</td>
<td align="center">iso_M</td>
<td align="center">iso_M-1</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">QE20140321-04</td>
<td align="center">H</td>
<td align="center">iso_M</td>
<td align="center">iso_M-2</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">QE20140321-05</td>
<td align="center">H</td>
<td align="center">iso_M</td>
<td align="center">iso_M-2</td>
<td align="center">4</td>
</tr>
</tbody>
</table>
<p>It is also required to activate the <em>silac</em> option in the yaml file as follows:</p>
<pre><code>silac: 
  enabled : 1 # 1 for SILAC experiments</code></pre>
<p><a name="qualitycontrol"></a></p>
<!--
Quality Control
-------------------------------------------------------------------------------
-->
</div>
</div>
<div id="quality-control" class="section level1">
<h1 class="hasAnchor">
<a href="#quality-control" class="anchor"></a>QUALITY CONTROL</h1>
<p><code>artMS</code> provides 3 functions to perform QC analyses.</p>
<p><a name="qcbasicevidence"></a></p>
<div id="basic-qc-evidence-txt-based" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-qc-evidence-txt-based" class="anchor"></a>Basic QC (<code>evidence.txt</code>-based)</h2>
<p>The basic quality control analysis takes as input both the <code>evidence.txt</code> and <a href="#inputfiles">keys.txt</a> files and generates several QC plots exploring different aspects of the MS data. Run it as follows:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/artmsQualityControlEvidenceBasic.html">artmsQualityControlEvidenceBasic</a></span><span class="op">(</span>
  evidence_file <span class="op">=</span> <span class="va">artms_data_ph_evidence</span>,
  keys_file <span class="op">=</span> <span class="va">artms_data_ph_keys</span>,
  prot_exp <span class="op">=</span> <span class="st">"PH"</span><span class="op">)</span></code></pre></div>
<p>The following <code>pdf</code> can be generated:</p>
<ul>
<li>
<strong>plotCORMAT (qcBasic_evidence.qcplot.CorrelationMatrix.pdf)</strong> (default): <em>Correlation matrix</em> for <em>technical replicates</em> (if available), <em>biological replicates</em>, and conditions based on MS Intensity values</li>
<li>
<strong>plotCORMAT (qcBasic_evidence.qcplot.CorrelationMatrixCluster.pdf</strong> (default): Clustered version of the <em>Correlation matrices</em> as for <em>.CorrelationMatrix.pdf</em>
</li>
<li>
<strong>plotINTMISC (qcBasic_evidence.qcplot.IntensityStats.pdf)</strong>: several pages, including bar plots of <em>Total Sum of Intensities in BioReplicates</em>, <em>Total Sum of Intensities in Conditions</em>, <em>Total Peptide Counts in BioReplicates</em>,<br><em>Total Peptide Counts in conditions</em> grouped by categories (<code>CON</code>: contaminants, <code>PROT</code> peptides, <code>REV</code> reversed sequences used by MaxQuant to estimate the FDR); <em>Box plots</em> of MS Intensity values per biological replicates and conditions; <em>bar plots</em> of total intensity (excluding contaminants) by bioreplicates and conditions; Bar plots of <em>total feature counts</em> by bioreplicates and conditions.</li>
<li>
<strong>plotPTMSTATS (qcBasic_evidence.qcplot.PTMStats.pdf)</strong>: If any PTM is selected (<code>PH</code>, <code>UB</code>, <code>AC</code>) an extra pdf file will be generated with stats related to the selected modification, including: <em>bar plot of peptide counts and intensities</em>, broken by <code>PTM/other</code> categories; bar plots of <em>total sum-up of MS intensity values</em> by other/PTM categories.</li>
<li>
<strong>plotREPRO (qcBasic_evidence.qcplot.BasicReproducibility)</strong>: correlation dot plot for all the combinations of biological replicates of every condition, based on MS Intensity values of features (peptide+charge)</li>
<li>
<strong>plotINTDIST (qcBasic_evidence.qcplot.IntensityDistributions.pdf)</strong>: 2 pages. <em>Box-dot plot</em> and <em>Jitter plot</em> of MS (raw) intensity values for each biological replicate.</li>
</ul>
<p>Check <code>?artmsQualityControlEvidenceBasic()</code> to find out more options. Remember: by default, all the plots are printed to a <code>pdf</code> file by running:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/artmsQualityControlEvidenceBasic.html">artmsQualityControlEvidenceBasic</a></span><span class="op">(</span> 
    evidence_file <span class="op">=</span> <span class="va">artms_data_ph_evidence</span>,
    keys_file <span class="op">=</span> <span class="va">artms_data_ph_keys</span>,
    prot_exp <span class="op">=</span> <span class="st">"PH"</span>, 
    plotPTMSTATS <span class="op">=</span> <span class="cn">TRUE</span>,
    plotINTDIST <span class="op">=</span> <span class="cn">FALSE</span>, plotREPRO <span class="op">=</span> <span class="cn">FALSE</span>,
    plotCORMAT <span class="op">=</span> <span class="cn">FALSE</span>, plotINTMISC <span class="op">=</span> <span class="cn">FALSE</span>,
    printPDF <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="artMS_vignette_files/figure-html/unnamed-chunk-4-1.png" width="700"><img src="artMS_vignette_files/figure-html/unnamed-chunk-4-2.png" width="700"><img src="artMS_vignette_files/figure-html/unnamed-chunk-4-3.png" width="700"><img src="artMS_vignette_files/figure-html/unnamed-chunk-4-4.png" width="700"><img src="artMS_vignette_files/figure-html/unnamed-chunk-4-5.png" width="700"><img src="artMS_vignette_files/figure-html/unnamed-chunk-4-6.png" width="700"></p>
<p><a name="qcextendedevidence"></a></p>
</div>
<div id="extended-qc-evidence-txt-based" class="section level2">
<h2 class="hasAnchor">
<a href="#extended-qc-evidence-txt-based" class="anchor"></a>Extended QC (<code>evidence.txt</code>-based)</h2>
<p>It takes as <a href="#inputfiles">input</a> the <code>evidence.txt</code> and <code>keys.txt</code> files as follows:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/artmsQualityControlEvidenceExtended.html">artmsQualityControlEvidenceExtended</a></span><span class="op">(</span>
   evidence_file <span class="op">=</span> <span class="va">artms_data_ph_evidence</span>,
   keys_file <span class="op">=</span> <span class="va">artms_data_ph_keys</span><span class="op">)</span></code></pre></div>
<p>and generates the following QC plots:</p>
<ul>
<li><p><strong>plotCS (qcExtended_evidence.qcplot.ChargeState)</strong>: charge state distribution of PSMs confidently identified in each BioReplicate.</p></li>
<li>
<p><strong>plotIC (qcExtended_evidence.qcplot.PCA.pdf)</strong>: pairwise intensity correlation and Principal Component Analysis (PCA)</p>
<ul>
<li>Page 1 and 3: pairwise peptide and protein intensity correlation and scatter plot between any 2 BioReplicates, respectively.</li>
<li>Page 2 and 4: principal component analysis at the intensity level for both peptide and proteins, respectively.</li>
</ul>
</li>
<li>
<p><strong>plotIONS (qcExtended_evidence.qcplot.Ions.pdf)</strong>: A peptide ion is defined in the context of m/z, in other words, a unique peptide sequence may give rise to multiple ions with different charge state and/or amino acid modification.</p>
<ul>
<li>Page 1: number of ions confidently identified in each BioReplicate (top panel: non-contaminants, bottom: contaminants)</li>
<li>Page 2: mean number of peptide ions per condition with error bar showing the standard error of the mean (categories: non-contaminants / contaminants)</li>
</ul>
</li>
<li><p><strong>plotME (qcExtended_evidence.qcplot.MassError.pdf)</strong>: Distribution of precursor error for all PSMs confidently identified in each BioReplicate.</p></li>
<li><p><strong>plotMOCD (qcExtended_evidence.qcplot.MZ.pdf)</strong>: Distribution of precursor mass-over-charge for all PSMs confidently identified in each BioReplicate.</p></li>
<li>
<p><strong>plotPIO (qcExtended_evidence.qcplot.PepIonOversampling.pdf)</strong>:</p>
<ul>
<li>Page 1: proportion of all peptide ions (including peptides matched across runs) fragmented once, twice and thrice or more.</li>
<li>Page 2: proportion of peptide ions (with intensity detected) fragmented once, twice and thrice or more.</li>
<li>Page 3: proportion of peptide ions (with intensity detected and MS/MS identification) fragmented once, twice, and 3 or more</li>
</ul>
</li>
<li><p><strong>plotPEPDETECT (qcExtended_evidence.qcplot.PeptideDetection.pdf)</strong>: frequency of peptide detection across BioReplicates by condition, showing the percentage of peptides detected once, twice, thrice, and so on (based on the number of bioreplicates for each condition).</p></li>
<li>
<p><strong>plotPEPICV (qcExtended_evidence.qcplot.PeptideIntensity.pdf)</strong>: Peptide intensity coefficient of variance (CV) plot.<br>
The CV is calculated for each feature (peptide ion) identified in more than one replicate.</p>
<ul>
<li>Page 1 shows the distribution of CV’s for each condition, while</li>
<li>Page 2 shows the distribution of CV’s within 4 bins of intensity (i.e., 4 quantiles of average intensity).</li>
</ul>
</li>
<li>
<p><strong>plotPEPTIDES (qcExtended_evidence.qcplot.Peptides.pdf)</strong>: peptide statistics plot.</p>
<ul>
<li>Page 1: number of unique peptide sequences (disregards the charge state or amino acid modifications) confidently identified in each BioReplicate (top panel: non-contaminants, bottom: contaminants)</li>
<li>Page 2: mean number of peptides per condition with error bar showing the standard error of the mean.</li>
</ul>
</li>
<li><p><strong>plotPEPTOVERLAP (qcExtended_evidence..qcplot.PeptidesOverlap.pdf)</strong>: peptide overlaps across bioreplicates (page 1) and conditions (page 2)</p></li>
<li>
<p><strong>plotPROTDETECT (qcExtended_evidence.qcplot.ProteinDetection.pdf)</strong>: Protein detection frequency plot:</p>
<ul>
<li>Page 1: protein group frequency of detection across BioReplicates for each condition, showing the percentage of proteins detected per bioreplicates</li>
<li>Page 2: feature (peptide ion) intensity distribution within each BioReplicate (potential contaminant proteins are plot separately).</li>
<li>Page 3: density of feature intensity for different feature types (i.e., MULTI-MSMS, MULTI-SECPEP).</li>
</ul>
</li>
<li>
<p><strong>plotPROTICV (qcExtended_evidence.qcplot.ProteinIntensityCV.pdf)</strong>: protein intensity coefficient of variance (CV) plot. The CV is calculated for each protein (after summing the peptide intensities) identified in more than one replicate.</p>
<ul>
<li>Page 1: istribution of CV’s for each condition</li>
<li>Page 2: distribution of CV’s within 4 bins of intensity (i.e., 4 quantiles of average intensity).</li>
</ul>
</li>
<li>
<p><strong>plotPROTEINS (qcExtended_evidence.qcplot.Proteins.pdf)</strong>: protein statistics,</p>
<ul>
<li>Page 1: number of protein groups confidently identified in each BioReplicate.</li>
<li>Page 2: mean number of protein groups per condition with error bar showing the standard error of the mean (categories: non-contaminants / contaminants)</li>
</ul>
</li>
<li><p><strong>plotPROTOVERLAP (qcExtended_evidence..qcplot.ProteinOverlap.pdf)</strong>: Protein overlap across bioreplicates (page 1) and conditions (page 2)</p></li>
<li>
<p><strong>plotPSM (qcExtended_evidence.qcplot.PSM.pdf)</strong> : Peptide-spectrum-matches (PSMs).</p>
<ul>
<li>Page 1: number of PSMs confidently identified in each BioReplicate.</li>
<li>Page 2: mean number of PSMs per condition with error bar showing the standard error of the mean (categories: non-contaminants / contaminants)</li>
</ul>
</li>
<li>
<p><strong>plotIDoverlap (qcExtended_evidence.qcplot.ID-Overlap.pdf)</strong>: heatmap of pairwise identification overlap:</p>
<ul>
<li>Page 1: peptide identification overlap, only peptides detected and identified between any 2 BioReplicates</li>
<li>Page 2: protein identification overlap, only proteins with at least 1 peptide detected and identified between any 2 BioReplicates</li>
</ul>
</li>
<li>
<p><strong>plotSP (qcExtended_evidence.qcplot.SamplePrep.pdf)</strong>: sample quality metrics.</p>
<ul>
<li>Page 1: missing cleavage distribution of all peptides confidently identified in each BioReplicate.</li>
<li>Page 2: fraction of peptides with at least one methionine oxidized in each BioReplicate.</li>
</ul>
</li>
<li><p><strong>plotTYPE (qcExtended_evidence.qcplot.Type.pdf)</strong>: identification type. MaxQuant classifies each peptide identification into different categories (e.g., MSMS, MULTI-MSMS, MULTI-SECPEP). This plot shows the distribution of identification type in each BioReplicate</p></li>
</ul>
<p>Examples: printing <code>plotTYPE</code>, <code>plotPEPICV</code>, and <code>plotPCA</code> plots only:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/artmsQualityControlEvidenceExtended.html">artmsQualityControlEvidenceExtended</a></span><span class="op">(</span>
  evidence_file <span class="op">=</span> <span class="va">artms_data_ph_evidence</span>,
  keys_file <span class="op">=</span> <span class="va">artms_data_ph_keys</span>,
  plotPCA <span class="op">=</span> <span class="cn">TRUE</span>,
  plotTYPE <span class="op">=</span> <span class="cn">TRUE</span>,
  plotPEPTIDES <span class="op">=</span> <span class="cn">TRUE</span>,
  plotPSM <span class="op">=</span> <span class="cn">FALSE</span>,
  plotIONS <span class="op">=</span> <span class="cn">FALSE</span>,
  plotPEPTOVERLAP <span class="op">=</span> <span class="cn">FALSE</span>,
  plotPROTEINS <span class="op">=</span> <span class="cn">FALSE</span>,
  plotPROTOVERLAP <span class="op">=</span> <span class="cn">FALSE</span>,
  plotPIO <span class="op">=</span> <span class="cn">FALSE</span>,
  plotCS <span class="op">=</span> <span class="cn">FALSE</span>,
  plotME <span class="op">=</span> <span class="cn">FALSE</span>,
  plotMOCD <span class="op">=</span> <span class="cn">FALSE</span>,
  plotPEPICV <span class="op">=</span> <span class="cn">FALSE</span>,
  plotPEPDETECT <span class="op">=</span> <span class="cn">FALSE</span>,
  plotPROTICV <span class="op">=</span> <span class="cn">FALSE</span>,
  plotPROTDETECT <span class="op">=</span> <span class="cn">FALSE</span>,
  plotIDoverlap <span class="op">=</span> <span class="cn">FALSE</span>,
  plotSP <span class="op">=</span> <span class="cn">FALSE</span>,
  printPDF <span class="op">=</span> <span class="cn">FALSE</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="artMS_vignette_files/figure-html/unnamed-chunk-6-1.png" width="700"><img src="artMS_vignette_files/figure-html/unnamed-chunk-6-2.png" width="700"><img src="artMS_vignette_files/figure-html/unnamed-chunk-6-3.png" width="700"><img src="artMS_vignette_files/figure-html/unnamed-chunk-6-4.png" width="700"><img src="artMS_vignette_files/figure-html/unnamed-chunk-6-5.png" width="700"><img src="artMS_vignette_files/figure-html/unnamed-chunk-6-6.png" width="700"><img src="artMS_vignette_files/figure-html/unnamed-chunk-6-7.png" width="700"></p>
<p><a name="qcextendedsummary"></a></p>
</div>
<div id="extended-qc-summary-txt-based" class="section level2">
<h2 class="hasAnchor">
<a href="#extended-qc-summary-txt-based" class="anchor"></a>Extended QC (<code>summary.txt</code> based)</h2>
<p>It requires two files:</p>
<ul>
<li>
<a href="#inputfiles">keys.txt</a> file</li>
<li>MaxQuant <code>summary.txt</code> file. As described by MaxQuant’s <code>table.pdf</code>, the summary file contains summary information for all the raw files processed with a single MaxQuant run, including statistics on the peak detection. The QC analysis of this file gathers a quick overview on the quality of every RawFile based on this <code>summary.txt</code>. Run it as follows:</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/artmsQualityControlSummaryExtended.html">artmsQualityControlSummaryExtended</a></span><span class="op">(</span>summary_file <span class="op">=</span> <span class="st">"summary.txt"</span>,
                                    keys_file <span class="op">=</span> <span class="va">artms_data_ph_keys</span><span class="op">)</span></code></pre></div>
<p>It generates the following <code>pdf</code> plots:</p>
<ul>
<li><p><strong>plotMS1SCANS (.qcplot.MS1scans.pdf)</strong>: generates MS1 scan counts plot: Page 1 shows the number of MS1 scans in each BioReplicate. If replicates are present, Page 2 shows the mean number of MS1 scans per condition with error bar showing the standard error of the mean. If <code>isFractions</code> is <code>TRUE</code>, each fraction is a stack on the individual bar graphs.</p></li>
<li><p><strong>plotMS2 (.qcplot.MS2scans.pdf)</strong>: generates MS2 scan counts plot: Page 1 shows the number of MSs scans in each BioReplicate. If replicates are present, Page 2 shows the mean number of MS1 scans per condition with error bar showing the standard error of the mean. If <code>isFractions</code> is <code>TRUE</code>, each fraction is a stack on the individual bar graphs.</p></li>
<li><p><strong>plotMSMS (.qcplot.MSMS.pdf)</strong>: generates MS2 identification rate (%) plot: Page 1 shows the fraction of MS2 scans confidently identified in each BioReplicate. If replicates are present, Page 2 shows the mean rate of MS2 scans confidently identified per condition with error bar showing the standard error of the mean. If <code>isFractions</code> <code>TRUE</code>, each fraction is a stack on the individual bar graphs.</p></li>
<li><p><strong>plotISOTOPE (.qcplot.Isotope.pdf)</strong>: generates Isotope Pattern counts plot: Page 1 shows the number of Isotope Patterns with charge greater than 1 in each BioReplicate. If replicates are present, Page 2 shows the mean number of Isotope Patterns with charge greater than 1 per condition with error bar showing the standard error of the mean. If <code>isFractions</code> <code>TRUE</code>, each fraction is a stack on the individual bar graphs.</p></li>
</ul>
<!--
RELATIVE QUANTIFICATION
-------------------------------------------------------------------------------
--><p><a name="relquan"></a></p>
</div>
</div>
<div id="relative-quantification" class="section level1">
<h1 class="hasAnchor">
<a href="#relative-quantification" class="anchor"></a>RELATIVE QUANTIFICATION</h1>
<p>The relative quantification is a fundamental step in the analysis of MS data. <code>artMS</code> facilitates and simplifies the analysis using <a href="http://msstats.org/">MSstats</a>, a fantastic statistical package for the relative quantification of Mass-Spectrometry based proteomics.</p>
<p>All the options and parameters required to run a relative quantification analysis using <code>MSstats</code> (in addition to other options) are summarized in <code>artMS</code> through a configuration file in <code>.yaml</code> format. Check the <a href="#inputfiles">input-files</a> section to find out more about each of the options.</p>
<p>Different types of proteomics experiments can be quantified including changes in global protein abundance (AB), affinity purification mass spectrometry (APMS), and different type of posttranslational modifications, including phosphorylation (PH), ubiquitination (UB), and acetylation (AC).</p>
<p><code>artMS</code> also enables the relative quantification of untargeted polar metabolites using the alignment table generated by <a href="https://sciex.com/products/software/markerview-software">MarkerView</a>. This means that <code>artMS</code> does not require an ID for the metabolites, as the m/z and retention time will be combined and used as identifiers.</p>
<p><a name="globalab"></a></p>
<div id="quantification-of-changes-in-global-protein-abundance" class="section level2">
<h2 class="hasAnchor">
<a href="#quantification-of-changes-in-global-protein-abundance" class="anchor"></a>Quantification of Changes in Global Protein Abundance</h2>
<p>The quantification of changes in protein abundance between different conditions requires to fill up the following sections of the <a href="#configfile">config file</a>:</p>
<pre><code>files:
  evidence : /path/to/the/evidence.txt
  keys : /path/to/the/keys.txt
  contrasts : /path/to/the/contrast.txt
  output : /path/to/the/output/results_ptmGlobal/results.txt
  .
  .
  .
data:
  .
  .
  .
  filters:
    modifications : AB </code></pre>
<p>The remaining options can be left unmodified (and run the default parameters). Then run the following <code>artMS</code> function:</p>
<pre><code><a href="../reference/artmsQuantification.html">artmsQuantification(
  yaml_config_file = '/path/to/config/file/artms_ab_config.yaml')</a></code></pre>
<p><a name="globalptm"></a></p>
</div>
<div id="quantification-of-changes-in-global-phosphorylation-ubiquitination-or-acetylation" class="section level2">
<h2 class="hasAnchor">
<a href="#quantification-of-changes-in-global-phosphorylation-ubiquitination-or-acetylation" class="anchor"></a>Quantification of Changes in Global Phosphorylation, Ubiquitination, or Acetylation</h2>
<p><strong><em>Warning: This quantification is only possible for experiments that have used methods to enrich phosphopeptides, ubiquitinated, or acetylated peptides prior to the mass spectrometry analysis.</em></strong></p>
<p>The <strong>global phosphorylation, ubiquitination, or acetylation</strong> quantification analysis calculates changes in phosphorylation, ubiquitination, or acetylation at the <em>protein level</em>. This means that all the <strong>modified</strong> peptides are used to quantify changes in protein phosphorylation, ubiquitination, or acetylation between different conditions. The <strong>site-specific</strong> analysis (<a href="#siteptm">explained next</a>) would quantify changes at the <em>peptide level</em>, i.e., each modified peptide is quantify independently between the different conditions.</p>
<p>Only two sections need to be filled up in the <strong>default</strong> <a href="https://bioconductor.org/packages/3.12/artMS/vignettes/input-files.html">configuration</a> file:</p>
<pre><code>files:
  evidence : /path/to/the/evidence.txt
  keys : /path/to/the/keys.txt
  contrasts : /path/to/the/contrast.txt
  output : /path/to/the/output/results_ptmGlobal/results.txt
  .
  .
  .
data:
  .
  .
  .
  filters:
    modifications : PH # Use "UB" for ubiquination, "AC" for acetylation</code></pre>
<p>The remaining options can be left unmodified.</p>
<p>Once the configuration <code>yaml</code> file is ready, run the following command:</p>
<pre><code><a href="../reference/artmsQuantification.html">artmsQuantification(
  yaml_config_file = '/path/to/config/file/artms_phglobal_config.yaml')</a></code></pre>
<p><a name="siteptm"></a></p>
</div>
<div id="ptm-sitepeptide-specific-quantification-of-changes-ph-ub-ac" class="section level2">
<h2 class="hasAnchor">
<a href="#ptm-sitepeptide-specific-quantification-of-changes-ph-ub-ac" class="anchor"></a>PTM-Site/Peptide-specific Quantification of Changes (PH, UB, AC)</h2>
<p><strong><em>Warning: This quantification is only possible for experiments that have used methods to enrich phosphopeptides or ubiquitinated peptides prior to the mass spectrometry analysis.</em></strong></p>
<p>Abbreviations:</p>
<ul>
<li>PH = Protein phosphorylation</li>
<li>UB = Protein Ubiquitination</li>
<li>AC = Protein Acetylation</li>
</ul>
<p>The <code>site-specific</code> analysis quantifies changes at the modified peptide level. This means that changes in every modified (PH, UB, or AC) peptide of a given protein will be quantified individually. The caveat is that the proportion of missing values should increase relative to the <strong>global</strong> analysis. Both <strong>sites</strong> and <strong>global</strong> ptm analysis are highly correlated due to the usually only one or two peptides drive the overall changes in PTMs for every protein.</p>
<p>To run a site/peptide specific analysis follow these steps:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Important pre-processing step on the evidence file to enable the ptm-site/peptide-specific analysis</strong>. This step takes any of the Proteins id columns selected by the user (either <code>Leading razor protein</code>, <code>Leading protein</code>, or <code>Proteins</code>) and re-annotates it to incorporate the ptm-site/peptide-specific information. By default, this function converts the column <code>Leading razor protein</code>. This step is <em>computational expensive</em>, which means that it might take several minutes to finish (depending on the size of the fasta database, evidence file, computer power, etc)</li>
</ol>
<p>It also requires the same reference proteome (fasta sequence database) used for the MaxQuant search.</p>
<p><em>For phosphorylation</em>:</p>
<pre><code><a href="../reference/artmsProtein2SiteConversion.html">artmsProtein2SiteConversion(
  evidence_file = "/path/to/the/evidence.txt", 
  ref_proteome_file = "/path/to/the/reference_proteome.fasta", 
  output_file = "/path/to/the/output/ph-sites-evidence.txt", 
  mod_type = "PH")</a></code></pre>
<p>As a result, the IDs in the “Leading razor protein” column will contain site/peptide-specific notation. For example:</p>
<p>Before: <code>P12345</code> After: <code>P12345_S23_S45</code></p>
<p><em>For ubiquitination</em>:</p>
<pre><code><a href="../reference/artmsProtein2SiteConversion.html">artmsProtein2SiteConversion(
  evidence_file = "/path/to/the/evidence.txt", 
  ref_proteome_file = "/path/to/the/reference_proteome.fasta", 
  output_file = "/path/to/the/output/ub-sites-evidence.txt", 
  mod_type = "UB")</a></code></pre>
<p><em>For acetylation</em>:</p>
<pre><code><a href="../reference/artmsProtein2SiteConversion.html">artmsProtein2SiteConversion(
  evidence_file = "/path/to/the/evidence.txt", 
  ref_proteome_file = "/path/to/the/reference_proteome.fasta", 
  output_file = "/path/to/the/output/ac-sites-evidence.txt", 
  mod_type = "AC")</a></code></pre>
<p><strong>Tip: How to re-annotate all the Protein columns on the same file</strong>.</p>
<p>By default, <code>artmsProtein2SiteConversion</code> doesn’t allow to overwrite the <code>evidence.txt</code> file for security reasons (you don’t want to lose the evidence file if something goes wrong). To overwrite the evidence file the argument <code>overwrite_evidence</code> must be turned on (<code>overwrite_evidence = TRUE</code>).</p>
<p>If the <code>column_name</code> argument is not used, <code>artmsProtein2SiteConversion</code> converts the <code>Leading razor protein</code> column, which is used in the quantification step when <code>protein_groups : remove</code> is selected (default). However, if <code>protein_groups : keep</code> is used, <code>artMS</code> will use the <code>Proteins</code> column. To convert the <code>Proteins</code> column to the site/peptide-specific notation, then add the argument <code>column_name = "Proteins"</code>.</p>
<p>To annotate both columns of the same file, first generate the “site-evidence.txt” file, and then use this same output file as the <code>evidence_file</code> and activate <code>overwrite.evidence = TRUE</code>.</p>
<p>In summary, to annotate both the “Leading razor protein” and <code>Proteins</code> columns follow these steps:</p>
<pre><code><a href="../reference/artmsProtein2SiteConversion.html"># Convert 'Leading razor protein' evidence's file column
artmsProtein2SiteConversion(
  evidence_file = "/path/to/the/evidence.txt", # ORIGINAL
  column_name = "Leading razor protein",
  ref_proteome_file = "/path/to/the/reference_proteome.fasta", 
  output_file = "/path/to/the/phsites-evidence.txt", # SITES VERSION
  mod_type = "PH")

# Convert 'Proteins' evidence's file column
artmsProtein2SiteConversion(
  evidence_file = "/path/to/the/phsites-evidence.txt", # &lt;- USE SITES VERSION
  column_name = "Proteins",
  overwrite_evidence = TRUE, # &lt;--- TURN ON
  ref_proteome_file = "/path/to/the/reference_proteome.fasta", 
  output_file = "/path/to/the/phsites-evidence.txt", # &lt;- SITES VERSION
  mod_type = "PH")</a></code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Generate a new configuration file (<code>phsites_config.yaml</code> or <code>ubsites_config.yaml</code>) as <a href="#configfile">explained above</a>, but using the “new” <code>sites-evidence.txt</code> file instead of the original <code>evidence.txt</code> file:</li>
</ol>
<pre><code>files:
  evidence : /path/to/the/evidence-site.txt
  keys : /path/to/the/keys.txt
  contrasts : /path/to/the/contrast.txt
  output : /path/to/the/output/results_ptmSITES/sites-results.txt # &lt;- this one
  .
  .
  .
data:
  .
  .
  .
  filters:
    modifications : PH # &lt;- Don't forget this one.</code></pre>
<p>Once the new <code>yaml</code> file has been created, execute:</p>
<pre><code><a href="../reference/artmsQuantification.html">artmsQuantification(
  yaml_config_file = '/path/to/config/file/phsites_config.yaml')</a></code></pre>
</div>
<div id="output-files" class="section level2">
<h2 class="hasAnchor">
<a href="#output-files" class="anchor"></a>Output files</h2>
<p>The files generated after succesfully running <code>artmsQuantification</code> are (based on <a href="http://msstats.org/wp-content/uploads/2017/01/MSstats_v3.7.3_manual.pdf">MSstats documentation</a>):</p>
<div id="txt-tab-delimited-files" class="section level3">
<h3 class="hasAnchor">
<a href="#txt-tab-delimited-files" class="anchor"></a>TXT (tab delimited) files</h3>
<ul>
<li>
<strong>results.txt</strong>: the results of the quantification in long format, i.e., each line is a protein for each comparison. It includes the following columns:
<ul>
<li>
<code>Protein</code>: Protein ID</li>
<li>
<code>Label</code>: comparison (from contrast.txt)</li>
<li>
<code>log2FC</code>: log2 fold change</li>
<li>
<code>SE</code>: standard error</li>
<li>
<code>Tvalue</code>: test statistic of the Student test</li>
<li>
<code>DF</code>: degree of freedom of the Student test</li>
<li>
<code>pvalue</code>: raw p-values</li>
<li>
<code>adj.pvalue</code>: p-values adjusted among all the proteins in the specific comparison using the approach by Benjamini and Hochberg</li>
<li>
<code>issue</code>: shows if there is any issue for inference in corresponding protein and comparison, for example, OneConditionMissing or CompleteMissing.</li>
<li>
<code>MissingPercentage</code>: percentage of random and censored missing in the corresponding run and protein out of the total number of feature in the corresponding protein.</li>
<li>
<code>ImputationPercentage</code>: percentage of imputation</li>
<li>Note: If a protein is completely missed in one of the conditions of a given comparison, it would get the flag <code>OneConditionMission</code> with <code>adj.pvalue=0</code> and <code>log2FC=Inf</code> or <code>-Inf</code> even though <code>pvalue=NA</code>. For example, if for the comparison <code>Condition A - Condition B</code> one protein is completely missed for condition B, then <code>log2FC = Inf</code> and <code>adj.pvalue = 0</code>. <code>SE</code>, <code>Tvalue</code>, and <code>pvalue</code> will all be <code>NA</code>.</li>
</ul>
</li>
<li>
<strong>results-annotated.txt</strong>: same as <code>results.txt</code> but 3 more columns of annotations, i.e., <code>Gene</code>, <code>ProteinName</code>, and <code>EntrezID</code>
</li>
<li>Different outputs from the MSstats dataProcess step (Normalizing and summarizing data, check <a href="http://msstats.org/msstats-2/">MSstats documentation</a> to find out more), including:
<ul>
<li><code>results_ModelQC.txt</code></li>
<li><code>results_RunlevelData.txt</code></li>
<li><code>results-mss-groupQuant.txt</code></li>
<li><code>results-mss-normalized.txt</code></li>
<li><code>results-mss-sampleQuant.txt</code></li>
</ul>
</li>
<li>Sample size and power calculation:
<ul>
<li><code>results_sampleSize.txt</code></li>
<li><code>results_experimentPower.txt</code></li>
</ul>
</li>
</ul>
</div>
<div id="plots-pdf" class="section level3">
<h3 class="hasAnchor">
<a href="#plots-pdf" class="anchor"></a>Plots (pdf)</h3>
<ul>
<li><code>results-heatmap.pdf</code></li>
<li><code>results-peptidecounts-perBait.pdf</code></li>
<li><code>results-peptidecounts.pdf</code></li>
<li><code>results-sign.pdf</code></li>
<li><code>results-volcano.pdf</code></li>
</ul>
<p><a name="analysisquan"></a></p>
</div>
</div>
</div>
<div id="analysis-of-quantifications" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis-of-quantifications" class="anchor"></a>ANALYSIS OF QUANTIFICATIONS</h1>
<p>Comprehensive analysis of the quantifications outputs obtained from the function <a href="#relquan">artmsQuantification()</a> section to find out more). It includes:</p>
<p><code><a href="../reference/artmsAnalysisQuantifications.html">artmsAnalysisQuantifications()</a></code> performs a comprehensive analysis of the quantifications outputs obtained from the function <a href="#relquan">artmsQuantification()</a>. It includes:</p>
<ul>
<li>Annotations</li>
<li>Summary files in different formats (xls, txt) and shapes (long, wide)</li>
<li>Basic Imputation (see <em>Notes on Imputation</em> and input option <strong><code>mnbr</code></strong> below)</li>
<li>Numerous summary plots</li>
<li>Enrichment analysis using <a href="https://cran.r-project.org/web/packages/gProfileR/index.html">Gprofiler</a>
</li>
<li>PCA of protein abundance</li>
<li>PCA of quantifications</li>
<li>Clustering analysis</li>
</ul>
<div id="inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#inputs" class="anchor"></a>Inputs</h2>
<p>It takes as input two files generated from the previous quantification step (<a href="#relquan">artmsQuantification()</a>)</p>
<ul>
<li>
<code>-results.txt</code> : MSstats quantification results</li>
<li>
<code>-results_ModelQC.txt</code> : MSstats normalized abundance values. It will be used to extract details about reproducibility.</li>
</ul>
<p>To run this analysis:</p>
<ol style="list-style-type: decimal">
<li>Set as the working directory the folder with the results obtained from <code><a href="../reference/artmsQuantification.html">artmsQuantification()</a></code>.</li>
</ol>
<pre><code><a href="https://rdrr.io/r/base/getwd.html">setwd('~/path/to/the/results_quantification/')</a></code></pre>
<p>And then run the following function (e.g., for a protein abundance “AB” experiment)</p>
<pre><code><a href="../reference/artmsAnalysisQuantifications.html">artmsAnalysisQuantifications(log2fc_file = "ab-results.txt",
                              modelqc_file = "ab-results_ModelQC.txt",
                              species = "human",
                              output_dir = "AnalysisQuantifications")</a></code></pre>
<p>A few comments on the available options for <code>artmsAnalysisQuantifications</code>:</p>
<ul>
<li>
<code>isPTM</code>: two options:
<ul>
<li>
<code>"noptm"</code>: use for protein abundance (<code>AB</code>), Affinity Purification-Mass Spectrometry (<code>APMS</code>), and global analysis of posttranslational modifications (<code>PH</code>, <code>UB</code>, <code>AC</code>) use the option .</li>
<li>
<code>"ptmsites"</code>: use for site specific PTM analysis.</li>
</ul>
</li>
<li>
<code>species</code>: this downstream analysis supports (for now) <code>"human"</code> and <code>"mouse"</code> only.</li>
<li>
<code>outliers</code>: outliers can be kept (default) or could be removed from the abundance data. Options:
<ul>
<li>
<code>keep</code>: keeps the outliers</li>
<li>
<code>iqr</code>: removes any outlier outside +/- 6 x interquartile range from the mean (recommended)</li>
<li>
<code>std</code>: it removes any outliers outside +/- 6 x the standard deviation from the mean</li>
</ul>
</li>
<li>
<code>enrich</code>: If <code>TRUE</code>, it will perform enrichment analysis using <code>gProfileR</code>
</li>
<li>
<code>isBackground</code>. If <code>enrich = TRUE</code>, the user can provide a background gene list (add the file path as well)</li>
<li>
<code>mnbr</code>: <strong>PARAMETER FOR NAIVE IMPUTATION</strong>. Minimal number of biological replicates for “naive imputation” and filtering. Default: <code>mnbr = 2</code>. <em>Details</em>: Intensity values for proteins/PTMs that are completely missed in one of the two conditions compared (“condition A”), but are found in at least 2 biological replicates (<code>mnbr = 2</code>) of the other “condition B”, are imputed (values artificially assigned) and the log2FC values calculated. The goal is to keep those proteins/PTMs that are consistently found in one of the two conditions (in this case “condition B”) and facilitate the inclusion in downstream analysis (if wished). The imputed intensity values are sampled from the lowest intensity values detected in the experiment, and (<strong>WARNING</strong>) the p-values are just randomly assigned between 0.05 and 0.01 for illustration purposes (when generating a volcano plot with the output of <code>artmsAnalysisQuantifications</code>) or to include them when making a cutoff of <code>p-value &lt; 0.05</code> for enrichment analysis or similar. <strong>CAUTION</strong>: <code>mnbr</code> would also add the constraint that any protein must be identified in at least <code>nmbr</code> biological replicates of the <strong>same</strong> condition or it will be filtered out. That is, if <code>mnbr = 2</code>, a protein found in two conditions but only in one biological replicate in each of them, it would be removed.</li>
</ul>
</div>
<div id="outputs" class="section level2">
<h2 class="hasAnchor">
<a href="#outputs" class="anchor"></a>Outputs</h2>
<p><strong>Summary file (<code>summary.xlsx</code>)</strong></p>
<p><em>Reminder</em>: for any given relative quantification, as for example WT-Mutant:</p>
<ul>
<li>Proteins with positive log2fc values (i.e. <code>log2fc &gt; 0</code>) are more abundant in the condition on the left / numerator (WT)</li>
<li>Proteins with negative log2fc values (i.e. <code>log2fc &lt; 0</code>) are more abundant in the condition on the right / denominator (Mutant)</li>
</ul>
<p>The summary excel file (<code>results-summary.xlsx</code>) gathers several tabs:</p>
<ul>
<li>
<code>log2fcImputed</code>: includes quantitative results.
<ul>
<li>Self-defining columns: <em>Protein</em>, <em>Gene</em>, <em>ProteinName</em>, <em>EntrezID</em>, <em>Comparison</em>, <em>log2FC</em>, <em>pvalue</em>, <em>adj.pvalue</em>.</li>
<li>Not self-defining columns:
<ul>
<li>
<em>imputed</em> (<code>yes/no</code>) indicates whether the iLog2FC value has been imputed according to the <code>nmbr</code> criteria (see above)</li>
<li>
<em>iLog2FC</em>, <em>iPvalue</em>: in addition to the model based log2fc and pvalues, these columns include imputed log2fc and pvalues (when completely missed in one of the conditions), followed by as many columns as the number of conditions, indicating the number of biological replicates in which each protein/ptmsite was identified.</li>
<li>
<em>CMA</em> stands for “Condition Most Abundant”, i.e. condition in which each protein was found more abundantly (based on the log2fc).</li>
</ul>
</li>
</ul>
</li>
<li>
<code>wide_iLog2fc</code>: log2fc values (including imputed values) in wide format, i.e., each row is a unique protein/ptmsite. The columns shows the values for each of the comparisons.</li>
<li>
<code>wide_iPvalue</code>: same as before, but for pvalues (including imputed)</li>
<li>
<code>enrichALL</code>: enrichment analysis using GProfileR for all the proteins changing significantly in any direction (ab(log2fc) &gt; 0 and pvalue &lt; 0.05)</li>
<li>
<code>enrich-MACpos</code>: enrichment of only the positive significant changes (log2fc &gt; 1, pvalue &lt; 0.05)</li>
<li>
<code>enirch-MACneg</code>: enrichment of only the negative significant changes (log2fc &lt; -1, pvalue &lt; 0.05)</li>
<li>
<code>enMACallCorum, enMACposCorum, enMACnegCorum</code>: same as above but only for protein complex enrichment analysis (based on CORUM)</li>
</ul>
<p><strong>Text files</strong></p>
<ul>
<li>
<code>results-log2fc-long.txt</code>: same as the <code>log2fcImputed</code> tab from the summary file</li>
<li>
<code>results-log2fc-wide.txt</code>: wide version (i.e., each row is an individual protein) of pvalues and adj.pvalues for each comparison</li>
</ul>
<p><strong>Gene Enrichment analysis</strong>: enrichment analysis only supported for human and mouse. Check the <a href="https://cran.r-project.org/web/packages/gProfileR/index.html">GprofileR documentation</a> to find out more about the details:</p>
<ul>
<li>
<code>results-enrich-MAC-allsignificants.txt</code>: all significant changes (abs(log2fc) &gt; 1 &amp; pvalue &lt; 0.05)</li>
<li>
<code>results-enrich-MAC-positives.txt</code>: only positive significant changes (log2fc &gt; 1 &amp; pvalue &lt; 0.05)</li>
<li>
<code>results-enrich-MAC-negatives.txt</code>: all significant changes (based on p-value only)</li>
</ul>
<p><strong>Protein Complex Enrichment analysis (based on CORUM)</strong></p>
<ul>
<li><p><code>results-enrich-MAC-allsignificants-corum.txt</code></p></li>
<li><p><code>results-enrich-MAC-positives-corum.txt</code></p></li>
<li><p><code>results-enrich-MAC-negatives-corum.txt</code></p></li>
<li><p><code>results-enrich-MAC-allsignificants-corum.pdf</code></p></li>
<li><p><code>results-enrich-MAC-negatives-corum.pdf</code></p></li>
<li><p><code>results-enrich-MAC-positives-corum.pdf</code></p></li>
</ul>
<p><strong>Clustering</strong></p>
<ul>
<li><p><code>results.clustering.log2fc.all-overview.pdf</code></p></li>
<li><p><code>results.clustering.log2fc.all-zoom.pdf</code></p></li>
<li><p><code>results.clustering.log2fcSign.all-overview.pdf</code></p></li>
<li><p><code>results.clustering.log2fcSign.all-zoom.pdf</code></p></li>
<li><p><code>results.log2fc-clusterheatmap-enriched.txt</code></p></li>
<li><p><code>results.log2fc-clusterheatmap.txt</code></p></li>
<li><p><code>results.log2fc-clusterheatmap.pdf</code></p></li>
<li><p><code>results.log2fc-clusters.pdf</code></p></li>
</ul>
<p><strong>Correlations</strong></p>
<ul>
<li><code>results.correlationConditions.pdf</code></li>
<li><code>results.reproducibilityAbundance.pdf</code></li>
<li><code>results.correlationQuantifications.pdf</code></li>
<li><code>results.log2fc-corr.pdf</code></li>
</ul>
<p><strong>Miscellaneous</strong></p>
<ul>
<li><p><code>results.relativeABUNDANCE.pdf</code></p></li>
<li><p><code>results.distributions.pdf</code></p></li>
<li><p><code>results.distributionsFil.pdf</code></p></li>
<li><p><code>results.imputation.pdf</code></p></li>
<li><p><code>results.TotalQuantifications.pdf</code></p></li>
</ul>
<p><strong>PCA</strong></p>
<p><strong><em>Based on relative abundance</em></strong></p>
<ul>
<li><code>results-pca-pca01.pdf</code></li>
<li><code>results-pca-pca02.pdf</code></li>
<li><code>results-pca-pca03.pdf</code></li>
<li><code>results-pca-pca04.pdf</code></li>
</ul>
<p><strong><em>Based on significant changes</em></strong></p>
<ul>
<li><code>results.log2fc-dendro.pdf</code></li>
<li><code>results.log2fc-individuals-pca.pdf</code></li>
</ul>
<!--
MISCELLANEOUS FUNCTIONS
-------------------------------------------------------------------------------
--><p><a name="misc"></a></p>
</div>
</div>
<div id="miscellaneous-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#miscellaneous-functions" class="anchor"></a>MISCELLANEOUS FUNCTIONS</h1>
<p><code>artMS</code> also provides a number of very handy functions.</p>
<div id="annotate-data-frame-with-gene-symbol-name-entrez-based-on-uniprot-ids" class="section level2">
<h2 class="hasAnchor">
<a href="#annotate-data-frame-with-gene-symbol-name-entrez-based-on-uniprot-ids" class="anchor"></a>Annotate data.frame with Gene Symbol, Name, ENTREZ based on Uniprot IDs</h2>
<p>Takes the given <code>columnid</code> (of Uniprot IDs) from the input data.frame, and map the gene symbol, name, and entre id (source: <a href="https://bioconductor.org/packages/3.8/data/annotation/">bioconductor annotation packages</a>)</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># This example adds annotations to the evidence file available in</span>
<span class="co"># artMS, based on the column 'Proteins'.</span>

<span class="va">evidence_anno</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/artmsAnnotationUniprot.html">artmsAnnotationUniprot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">artms_data_ph_evidence</span>,
                                        columnid <span class="op">=</span> <span class="st">'Proteins'</span>,
                                        species <span class="op">=</span> <span class="st">'human'</span><span class="op">)</span></code></pre></div>
</div>
<div id="average-intensity-rt-cr" class="section level2">
<h2 class="hasAnchor">
<a href="#average-intensity-rt-cr" class="anchor"></a>Average Intensity, RT, CR</h2>
<p>Taking as input the evidence file, it will summarize and return back the average intensity, average retention time, and the average calibrated retention time for each protein. If a list of proteins is provided, then only those proteins will be summarized and returned. Check <code>?artmsAvgIntensityRT()</code> to find out more options.</p>
<pre><code>artmsAvgIntensityRT(evidence_file = '/path/to/the/evidence.txt)</code></pre>
</div>
<div id="change-column-name" class="section level2">
<h2 class="hasAnchor">
<a href="#change-column-name" class="anchor"></a>Change column name</h2>
<p>Changes a given column name in the input data.frame</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">artms_data_ph_evidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/artmsChangeColumnName.html">artmsChangeColumnName</a></span><span class="op">(</span>
                               dataset <span class="op">=</span> <span class="va">artms_data_ph_evidence</span>,
                               oldname <span class="op">=</span> <span class="st">"Phospho..STY."</span>,
                               newname <span class="op">=</span> <span class="st">"PH_STY"</span><span class="op">)</span></code></pre></div>
</div>
<div id="individual-abundance-dot-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#individual-abundance-dot-plots" class="anchor"></a>Individual abundance dot plots</h2>
<p>Protein abundance dot plots for each unique uniprot id. It can take a long time</p>
<pre><code><a href="../reference/artmsDataPlots.html">artmsDataPlots(input_file = "results/ab-results-mss-normalized.txt",
               output_file = "results/ab-results-mss-normalized.pdf")</a></code></pre>
</div>
<div id="enrichment-analysis-function" class="section level2">
<h2 class="hasAnchor">
<a href="#enrichment-analysis-function" class="anchor"></a>Enrichment analysis function</h2>
<p>Enrichment analysis based on a data.frame with <code>Gene</code> and <code>Comparison</code>/<code>Label</code> protein (i.e, typical MSstats results)</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The data must be annotated (Protein and Gene columns)</span>
<span class="va">data_annotated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/artmsAnnotationUniprot.html">artmsAnnotationUniprot</a></span><span class="op">(</span>
                      x <span class="op">=</span> <span class="va">artms_data_ph_msstats_results</span>,
                      columnid <span class="op">=</span> <span class="st">"Protein"</span>,
                      species <span class="op">=</span> <span class="st">"human"</span><span class="op">)</span>
<span class="co"># And then the enrichment</span>
<span class="va">enrich_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/artmsEnrichLog2fc.html">artmsEnrichLog2fc</a></span><span class="op">(</span>
                   dataset <span class="op">=</span> <span class="va">data_annotated</span>,
                   species <span class="op">=</span> <span class="st">"human"</span>,
                   background <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">data_annotated</span><span class="op">$</span><span class="va">Gene</span><span class="op">)</span>, 
                   verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div id="enrichment-analysis-using-gprofiler" class="section level2">
<h2 class="hasAnchor">
<a href="#enrichment-analysis-using-gprofiler" class="anchor"></a>Enrichment analysis using gProfileR</h2>
<p>Function that simplifies enrichment analysis using gProfileR</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># annotate the MSstats results to get the Gene name</span>
<span class="va">data_annotated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/artmsAnnotationUniprot.html">artmsAnnotationUniprot</a></span><span class="op">(</span>
                                     x <span class="op">=</span> <span class="va">artms_data_ph_msstats_results</span>,
                                     columnid <span class="op">=</span> <span class="st">"Protein"</span>,
                                     species <span class="op">=</span> <span class="st">"human"</span><span class="op">)</span>

<span class="co"># Filter the list of genes with a log2fc &gt; 2</span>
<span class="va">filtered_data</span> <span class="op">&lt;-</span> 
<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">data_annotated</span><span class="op">$</span><span class="va">Gene</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">data_annotated</span><span class="op">$</span><span class="va">log2FC</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>

<span class="co"># And perform enrichment analysis</span>
<span class="va">data_annotated_enrich</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/artmsEnrichProfiler.html">artmsEnrichProfiler</a></span><span class="op">(</span>
                                   x <span class="op">=</span> <span class="va">filtered_data</span>,
                                   categorySource <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'KEGG'</span><span class="op">)</span>,
                                   species <span class="op">=</span> <span class="st">"hsapiens"</span>,
                                   background <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">data_annotated</span><span class="op">$</span><span class="va">Gene</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="maxquant-evidence-file-to-saintexpress-format" class="section level2">
<h2 class="hasAnchor">
<a href="#maxquant-evidence-file-to-saintexpress-format" class="anchor"></a>MaxQuant evidence file to SAINTexpress format</h2>
<p>Converts the MaxQuant evidence file to the 3 required files by <a href="http://saint-apms.sourceforge.net/Main.html">SAINTexpress</a>. Choose one of the following quantitative MS metrics:</p>
<ul>
<li>MS spectral counts (use msspc)</li>
<li>MS intensities (use msint)</li>
</ul>
<pre><code><a href="../reference/artmsEvidenceToSaintExpress.html">artmsEvidenceToSaintExpress(evidence_file = "/path/to/evidence.txt", 
                            keys_file = "/path/to/keys.txt", 
                            ref_proteome_file = "/path/to/org.proteome.fasta")</a></code></pre>
</div>
<div id="maxquant-evidence-file-to-saintq-format" class="section level2">
<h2 class="hasAnchor">
<a href="#maxquant-evidence-file-to-saintq-format" class="anchor"></a>MaxQuant evidence file to SAINTq format</h2>
<p>Converts the MaxQuant evidence file to the required files by <a href="http://saint-apms.sourceforge.net/Main.html">SAINTq</a>. The user can filter based on either peptides with spectral counts (use <code>msspc</code>) or all the peptides (use <code>all</code>) for the analysis. The quantitative metric can be also chosen (either MS intensity or spectral counts)</p>
<pre><code><a href="../reference/artmsEvidenceToSAINTq.html">artmsEvidenceToSAINTq(evidence_file = "/path/to/evidence.txt", 
                      keys_file = "/path/to/keys.txt", 
                      output_dir = "saintq_input_files")</a></code></pre>
</div>
<div id="generate-phosfate-input-file" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-phosfate-input-file" class="anchor"></a>Generate Phosfate input file</h2>
<p>It generates the Phosfate input file from the <code>imputedL2fcExtended.txt</code> file resulting from running the <code><a href="../reference/artmsAnalysisQuantifications.html">artmsAnalysisQuantifications()</a></code> on a ph-site quantification (see above). Notice that the only species suported by PHOTON is humans.</p>
<pre><code><a href="../reference/artmsPhosfateOutput.html">artmsPhosfateOutput(inputFile = "your-imputedL2fcExtended.txt")</a></code></pre>
</div>
<div id="generate-photon-input-file" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-photon-input-file" class="anchor"></a>Generate Photon input file</h2>
<p>It generates the Photon input file from the <code>imputedL2fcExtended.txt</code> file resulting from running the <code><a href="../reference/artmsAnalysisQuantifications.html">artmsAnalysisQuantifications()</a></code> on a ph-site quantification (see above). Please, notice that the only species suported by PHOTON is humans.</p>
<pre><code><a href="../reference/artmsPhotonOutput.html">artmsPhotonOutput(inputFile = "your-imputedL2fcExtended.txt")</a></code></pre>
</div>
<div id="remove-contaminants-and-empty-proteins-from-the-maxquant-evidence-file" class="section level2">
<h2 class="hasAnchor">
<a href="#remove-contaminants-and-empty-proteins-from-the-maxquant-evidence-file" class="anchor"></a>Remove contaminants and empty proteins from the MaxQuant evidence file</h2>
<p>Remove contaminants and erroneously identified ‘reverse’ sequences by MaxQuant, in addition to empty protein ids</p>
<pre><code>evidencefiltered &lt;- artmsFilterEvidenceContaminants(x = artms_data_ph_evidence)</code></pre>
</div>
<div id="generate-ph-site-specific-evidence-file" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-ph-site-specific-evidence-file" class="anchor"></a>Generate ph-site specific evidence file</h2>
<p>Generate extended detailed ph-site file, where every line is a ph site instead of a peptide. Therefore, if one peptide has multiple ph sites it will be breaking down in multiple extra lines for each of the sites.</p>
<pre><code><a href="../reference/artmsGeneratePhSiteExtended.html">artmsGeneratePhSiteExtended(df = dfobject, 
                            species = "mouse", 
                            ptmType = "ptmsites",
                            output_name = log2fc_file)</a></code></pre>
<!--
METABOLOMICS
-------------------------------------------------------------------------------
-->
<p><a name="metabolomics"></a></p>
</div>
</div>
<div id="metabolomics" class="section level1">
<h1 class="hasAnchor">
<a href="#metabolomics" class="anchor"></a>METABOLOMICS</h1>
<p><code>artMS</code> enables the relative quantification of untargeted polar metabolites using the alignment table generated by <a href="https://sciex.com/products/software/markerview-software">MarkerView</a>. This means that the metabolites do not need to have an id in order to perform the quantification, as the m/z and retention time will be used as identifiers.</p>
<p><a href="https://sciex.com/products/software/markerview-software">MarkerView</a> is an ABSciex software that supports the files generated by Analyst software (<code>.wiff</code>) used to run our specific mass spectrometer (ABSciex Triple TOF 5600+). It also supports <code>.t2d</code> files generated by the Applied Biosystems 4700/4800 MALDI-TOF.</p>
<p>Markview is used to align mass spectrometry data from several samples for comparison. Using the import feature in the software, <code>.wiff</code> files (also <code>.t2d</code> MALDI-TOF files and tab-delimited <code>.txt</code> mass spectra data in mass-intensity format) are loaded for retention time alignment. Once the data files are selected, a series of windows will appear wherein peak finding, alignment, and filtering options can be entered and selected. These options include minimum spectral peak width, minimum retention time peak width, retention time and mass tolerance, and the ability to filter out peaks that do not appear in more than a user selected number of samples.</p>
<p>The alignment file is further processed and formatted to perform QC and relative quantification using the following <code>artMS</code> functions:</p>
<div id="convert-metabolomics" class="section level2">
<h2 class="hasAnchor">
<a href="#convert-metabolomics" class="anchor"></a>Convert Metabolomics</h2>
<p>Pre-process the markview <code>.txt</code> file to generate an “evidence-like” file by running:</p>
<pre><code><a href="../reference/artmsConvertMetabolomics.html">artmsConvertMetabolomics(input_file = "markview-output.txt", 
                         out_file = "metabolomics-evidence.txt")</a></code></pre>
</div>
<div id="qc-metabolomics" class="section level2">
<h2 class="hasAnchor">
<a href="#qc-metabolomics" class="anchor"></a>QC Metabolomics</h2>
<p>Perform quality control analysis on the metabolomics data by running:</p>
<pre><code><a href="../reference/artmsQualityControlMetabolomics.html">artmsQualityControlMetabolomics(evidence_file = "metabolomics-evidence.txt",
                                keys_file = "metabolomics-keys.txt")</a></code></pre>
<p>It generates the following plots:</p>
<ul>
<li>
<code>plotINTDIST.pdf</code> contains both <em>Box-dot plot</em> and <em>Jitter plot</em> of biological replicates based on MS (raw) intensity values.</li>
<li>
<code>plotREPRO.pdf</code> correlation dotplot for all the combinations of biological replicates of conditions, based on MS Intensity values using features (mz_rt+charge)</li>
<li>
<code>plotCORMAT.pdf</code>, includes up to 3 pdf files for technical replicates, biological replicates, and conditions. Each pdf file contains:
<ul>
<li>
<em>Correlation matrix</em> for all the biological replicates using MS Intensity values,</li>
<li>
<em>Clustering matrix</em> of the MS Intensities and correlation distribution</li>
<li>
<em>histogram</em> of the distribution of correlations</li>
</ul>
</li>
<li>
<code>plotINTMISC.pdf</code> the pdf contains several pages, including bar plots of <em>Total Sum of Intensities in BioReplicates</em>, <em>Total Sum of Intensities in Conditions</em>, <em>Total Feature Counts in BioReplicates</em>, <em>Total Feature Counts in conditions</em> separated by categories (INT: has a intensity value NOINT: no intensity value ) <em>Box plots</em> of MS Intensity values per biological replicates and conditions; <em>bar plots</em> of total intensity by bioreplicates and conditions; Barplots of <em>total feature counts</em> by bioreplicates and conditions.</li>
</ul>
</div>
<div id="relative-quantification-1" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-quantification-1" class="anchor"></a>Relative Quantification:</h2>
<p>The relative quantification is performed using <code>MSstats</code>. It requires a configuration file (<code>yaml</code> format, please check above). A template can be generated by running: <code><a href="../reference/artmsWriteConfigYamlFile.html">artmsWriteConfigYamlFile(config_file_name = "metab_config.yaml")</a></code>. The relative quantification is performed by running:</p>
<pre><code><a href="../reference/artmsQuantification.html">artmsQuantification(yaml_config_file = "metabConfig.yaml")</a></code></pre>
<!--
TESTING FILES
-------------------------------------------------------------------------------
-->
</div>
</div>
<div id="testing-files" class="section level1">
<h1 class="hasAnchor">
<a href="#testing-files" class="anchor"></a>TESTING FILES</h1>
<p>The artMS package provides the following testing datasets</p>
<p><strong>Phosphoproteomics dataset</strong>: example dataset consisting of two head and neck cancer cell lines (conditions <code>"Cal33"</code> and <code>"HSC6"</code>), 2 biological replicates each). The number of peptides was reduced to 1/8 due to bioconductor limitations on data size.</p>
<ul>
<li>Evidence file: <code>artms_data_ph_evidence</code>
</li>
<li>Keys file: <code>artms_data_ph_keys</code>
</li>
<li>Results file: <code>artms_data_ph_msstats_results</code>: results after running <code><a href="../reference/artmsQuantification.html">artmsQuantification()</a></code> on the reduced version</li>
</ul>
<p>The full data set (2 conditions, 4 biological replicates) can be found at the following urls:</p>
<ul>
<li><code>url_evidence &lt;- 'http://kroganlab.ucsf.edu/artms/ph/evidence.txt'</code></li>
<li><code>url_keys &lt;- 'http://kroganlab.ucsf.edu/artms/ph/keys.txt'</code></li>
</ul>
<p><strong>Protein Complexes dataset</strong>: downloaded (2017-08-01) from <a href="http://mips.helmholtz-muenchen.de/corum/">CORUM</a> database<br>
and further enriched with annotations of mouse mitochondrial complexes not available at CORUM. Used for complex enrichment calculations.</p>
<ul>
<li><code>artms_data_corum_mito_database</code></li>
</ul>
<p><strong>Pathogens Uniprot IDs</strong>:</p>
<ul>
<li>
<code>artms_data_pathogen_LPN</code>: <em>Legionella pneumophila philadelphia</em> (downloaded 2017-07-17)</li>
<li>
<code>artms_data_pathogen_TB</code>: <em>Mycobacterium tuberculosis</em> strain ATCC 35801 / TMC 107 / Erdman (downloaded 2018-04-01)</li>
</ul>
<p>Check the individual help pages (e.g, <code><a href="../reference/artms_data_ph_evidence.html">?artms_data_ph_evidence</a></code>) to find out more about them.</p>
<!--
HELP
-------------------------------------------------------------------------------
-->
</div>
<div id="help" class="section level1">
<h1 class="hasAnchor">
<a href="#help" class="anchor"></a>HELP</h1>
<ul>
<li>Errors or warnings? Please, <a href="https://github.com/biodavidjm/artMS/issues">submit them as a new issue</a> at the official Github repository</li>
<li>Any other inquiries: <a href="mailto:artms.help@gmail.com" class="email">artms.help@gmail.com</a>
</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by David Jimenez-Morales, Alexandre Rosa Campos, John Von Dollen, Nevan Krogan, Danielle Swaney.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
