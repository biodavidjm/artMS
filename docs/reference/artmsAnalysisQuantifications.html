<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Analysis of the Relative Quantifications — artmsAnalysisQuantifications • artMS</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Analysis of the Relative Quantifications — artmsAnalysisQuantifications" />
<meta property="og:description" content="Analysis of relative quantifications, including:
Annotations
Summary files in different format (xls, txt) and shapes (long, wide)
Numerous summary plots
Enrichment analysis using Gprofiler
PCA of quantifications
Clustering analysis
Basic imputation of missing values


To run this function, the following packages must be installed on your system:
From bioconductor:
BiocManager::install(c(&quot;ComplexHeatmap&quot;, &quot;org.Mm.eg.db&quot;))
From CRAN:
install.packages(c(&quot;factoextra&quot;, &quot;FactoMineR&quot;, &quot;gProfileR&quot;, &quot;PerformanceAnalytics&quot;))

" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-26635029-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-26635029-4');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">artMS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.10.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/artMS_vignette.html">artMS: Analytical R Tools for Mass Spectrometry</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/biodavidjm/artMS/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Analysis of the Relative Quantifications</h1>
    <small class="dont-index">Source: <a href='https://github.com/biodavidjm/artMS/blob/master/R/analysisQuantifications.R'><code>R/analysisQuantifications.R</code></a></small>
    <div class="hidden name"><code>artmsAnalysisQuantifications.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Analysis of relative quantifications, including:</p><ul>
<li><p>Annotations</p></li>
<li><p>Summary files in different format (xls, txt) and shapes (long, wide)</p></li>
<li><p>Numerous summary plots</p></li>
<li><p>Enrichment analysis using Gprofiler</p></li>
<li><p>PCA of quantifications</p></li>
<li><p>Clustering analysis</p></li>
<li><p>Basic imputation of missing values</p></li>
</ul>

<p>To run this function, the following packages must be installed on your system:</p><ul>
<li><p>From bioconductor:
<code><a href='https://rdrr.io/pkg/BiocManager/man/install.html'>BiocManager::install(c("ComplexHeatmap", "org.Mm.eg.db"))</a></code></p></li>
<li><p>From CRAN:
<code><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages(c("factoextra", "FactoMineR", "gProfileR", "PerformanceAnalytics"))</a></code></p></li>
</ul>

    </div>

    <pre class="usage"><span class='fu'>artmsAnalysisQuantifications</span><span class='op'>(</span>
  <span class='va'>log2fc_file</span>,
  <span class='va'>modelqc_file</span>,
  <span class='va'>species</span>,
  output_dir <span class='op'>=</span> <span class='st'>"analysis_quant"</span>,
  outliers <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"keep"</span>, <span class='st'>"iqr"</span>, <span class='st'>"std"</span><span class='op'>)</span>,
  enrich <span class='op'>=</span> <span class='cn'>TRUE</span>,
  l2fc_thres <span class='op'>=</span> <span class='fl'>1</span>,
  choosePvalue <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"adjpvalue"</span>, <span class='st'>"pvalue"</span><span class='op'>)</span>,
  isBackground <span class='op'>=</span> <span class='st'>"nobackground"</span>,
  isPtm <span class='op'>=</span> <span class='st'>"global"</span>,
  mnbr <span class='op'>=</span> <span class='fl'>2</span>,
  pathogen <span class='op'>=</span> <span class='st'>"nopathogen"</span>,
  plotPvaluesLog2fcDist <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plotAbundanceStats <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plotReproAbundance <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plotCorrConditions <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plotCorrQuant <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plotPCAabundance <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plotFinalDistributions <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plotPropImputation <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plotHeatmapsChanges <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plotTotalQuant <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plotClusteringAnalysis <span class='op'>=</span> <span class='cn'>TRUE</span>,
  data_object <span class='op'>=</span> <span class='cn'>FALSE</span>,
  printPDF <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>log2fc_file</th>
      <td><p>(char) MSstats results file location</p></td>
    </tr>
    <tr>
      <th>modelqc_file</th>
      <td><p>(char) MSstats modelqc file location</p></td>
    </tr>
    <tr>
      <th>species</th>
      <td><p>(char) Select one species. Species currently supported for
a full analysis (including enrichment analysis):</p><ul>
<li><p>HUMAN</p></li>
<li><p>MOUSE
To find out species supported only for annotation check
<code>?artmsIsSpeciesSupported()</code></p></li>
</ul></td>
    </tr>
    <tr>
      <th>output_dir</th>
      <td><p>(char) Name for the folder to output the results from the
function. Default is current directory (recommended to provide a new folder
name).</p></td>
    </tr>
    <tr>
      <th>outliers</th>
      <td><p>(char) It allows to keep or remove outliers. Options:</p><ul>
<li><p><code>keep</code> (default): it keeps outliers 'keep', 'iqr', 'std'</p></li>
<li><p><code>iqr</code> (recommended): remove outliers +/- 6 x Interquartile Range (IQR)</p></li>
<li><p><code>std</code> : 6 x standard deviation</p></li>
</ul></td>
    </tr>
    <tr>
      <th>enrich</th>
      <td><p>(logical) Performed enrichment analysis using GprofileR?
Only available for species HUMAN and MOUSE.
<code>TRUE</code> (default if "human" or "mouse" are the species) or <code>FALSE</code></p></td>
    </tr>
    <tr>
      <th>l2fc_thres</th>
      <td><p>(int) log2fc cutoff for enrichment analysis (default,
<code>l2fc_thres = 1.5</code>)</p></td>
    </tr>
    <tr>
      <th>choosePvalue</th>
      <td><p>(char) specify whether <code>pvalue</code> or <code>adjpvalue</code> should
use for the analysis. The default option is <code>adjpvalue</code>
(multiple testing correction).
But if the number of biological replicates for a given experiment is
too low (for example n = 2), then <code>choosePvalue = pvalue</code> is recommended.</p></td>
    </tr>
    <tr>
      <th>isBackground</th>
      <td><p>(char) background of gene names for enrichment analysis.
<code>nobackground</code> (default) will use the total number of genes detected.
Alternatively provided the file path name to the background gene list.</p></td>
    </tr>
    <tr>
      <th>isPtm</th>
      <td><p>(char) Is a ptm-site quantification?</p><ul>
<li><p><code>global</code> (default),</p></li>
<li><p><code>ptmsites</code> (for site specific analysis),</p></li>
<li><p><code>ptmph</code> (Jeff Johnson script output evidence file)</p></li>
</ul></td>
    </tr>
    <tr>
      <th>mnbr</th>
      <td><p>(int) <strong>PARAMETER FOR NAIVE IMPUTATION</strong>:
"minimal number of biological replicates" for "naive
imputation" and filtering. Default: <code>mnbr = 2</code>. Details:
Intensity values for proteins/PTMs that are completely missed in one
of the two conditions compared ("condition A"), but are found in
at least 2 biological replicates (<code>mnbr = 2</code>) of the other "condition B",
are imputed (values artificially assigned) and the log2FC values calculated.
The goal is to keep those proteins/PTMs that are consistently found in
one of the two conditions (in this case "condition B") and facilitate the
inclusion in downstream analysis (if wished). The imputed intensity values
are sampled from the lowest intensity values detected in the experiment,
and (<strong>WARNING</strong>) the p-values are just randomly assigned between
0.05 and 0.01 for illustration purposes (when generating a volcano
plot with the output of <code>artmsAnalysisQuantifications</code>) or to include
them when making a cutoff of p-value &lt; 0.05 for enrichment analysis
<strong>CAUTION</strong>: <code>mnbr</code> would also add the constraint that any protein
must be identified in at least <code>nmbr</code> biological replicates of the
<strong>same</strong> condition or it will be filtered out. That is,
if <code>mnbr = 2</code>, a protein found in two conditions but only in one
biological replicate in each of them, it would be removed.</p></td>
    </tr>
    <tr>
      <th>pathogen</th>
      <td><p>(char) Is there a pathogen in the dataset as well?
if it does not, then use <code>pathogen = nopathogen</code> (default).
Pathogens available: <code>tb</code> (Tuberculosis), <code>lpn</code> (Legionella)</p></td>
    </tr>
    <tr>
      <th>plotPvaluesLog2fcDist</th>
      <td><p>(logical) If <code>TRUE</code> (default) plots pvalues
and log2fc distributions</p></td>
    </tr>
    <tr>
      <th>plotAbundanceStats</th>
      <td><p>(logical) If <code>TRUE</code> (default) plots stats graphs
about abundance values</p></td>
    </tr>
    <tr>
      <th>plotReproAbundance</th>
      <td><p>(logical) If <code>TRUE</code> plots reproducibility
based on normalized abundance values</p></td>
    </tr>
    <tr>
      <th>plotCorrConditions</th>
      <td><p>(logical) If <code>TRUE</code> plots correlation
between the different conditions</p></td>
    </tr>
    <tr>
      <th>plotCorrQuant</th>
      <td><p>(logical) if <code>TRUE</code> plots correlation between the
available quantifications (comparisons)</p></td>
    </tr>
    <tr>
      <th>plotPCAabundance</th>
      <td><p>(logical) if <code>TRUE</code> performs PCA analysis of
conditions using normalized abundance values</p></td>
    </tr>
    <tr>
      <th>plotFinalDistributions</th>
      <td><p>(logical) if <code>TRUE</code> plots distribution of both
log2fc and pvalues</p></td>
    </tr>
    <tr>
      <th>plotPropImputation</th>
      <td><p>(logical) if <code>TRUE</code> plots proportion of overall
imputation</p></td>
    </tr>
    <tr>
      <th>plotHeatmapsChanges</th>
      <td><p>(logical) if <code>TRUE</code> plots heatmaps of quantified
changes (both all and significant only). Only if <code>printPDF</code> is also <code>TRUE</code></p></td>
    </tr>
    <tr>
      <th>plotTotalQuant</th>
      <td><p>(logical) if <code>TRUE</code> plots barplot of total number of
quantifications per comparison</p></td>
    </tr>
    <tr>
      <th>plotClusteringAnalysis</th>
      <td><p>(logical) if <code>TRUE</code> performs clustering
analysis between quantified comparisons (more than 1 comparison required)</p></td>
    </tr>
    <tr>
      <th>data_object</th>
      <td><p>(logical) flag to indicate whether the required files
are data objects. Default is FALSE</p></td>
    </tr>
    <tr>
      <th>printPDF</th>
      <td><p>If <code>TRUE</code> (default) prints out the pdfs. Warning: plot
objects are not returned due to the large number of them.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>(logical) <code>TRUE</code> (default) shows function messages</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>(data.frame) summary of quantifications, including annotations,
enrichments, etc</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Testing that the files cannot be empty</span>
<span class='fu'>artmsAnalysisQuantifications</span><span class='op'>(</span>log2fc_file <span class='op'>=</span> <span class='cn'>NULL</span>,
                              modelqc_file <span class='op'>=</span> <span class='cn'>NULL</span>,
                              species <span class='op'>=</span> <span class='cn'>NULL</span>,
                              output_dir <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>---------------------------------------------</span></div><div class='output co'>#&gt; <span class='message'>artMS: ANALYSIS OF QUANTIFICATIONS</span></div><div class='output co'>#&gt; <span class='message'>---------------------------------------------</span></div><div class='output co'>#&gt; [1] "The evidence_file, modelqc_file, species and output_dir arguments cannot be NULL"</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Jimenez-Morales, Alexandre Rosa Campos, John Von Dollen, Nevan Krogan, Danielle Swaney.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


